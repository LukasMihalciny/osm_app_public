"use strict";(self["webpackChunkosmapp_webpack_3xx"]=self["webpackChunkosmapp_webpack_3xx"]||[]).push([[761],{6884:function(e,a,t){var n=t(8700),s=t(6343),i=t(3175);class o{identity_scan(e,a){let t={action_name:"identity-scan",method:"GET",url:(0,n.A)().endpoint_url()+"online/identity-scan/?"+s.A.add_token_as_parameter()};t.url+="&serviceToken=veriface&scanGroupName="+e+"&identType="+a;let o=new i.A;return o.prepare_params(t).handle_response().catch((e=>{throw e}))}identity_check(e){let a={action_name:"identity-scan-check",method:"GET",url:(0,n.A)().endpoint_url()+"online/identity-scan-check/?"+s.A.add_token_as_parameter()};a.url+="&serviceToken=veriface&scanGroupName="+e;let t=new i.A;return t.prepare_params(a).handle_response().catch((e=>{throw e}))}identity_refresh(){let e={action_name:"id-scan/get-scan-groups",method:"GET",url:(0,n.A)().endpoint_url()+"api/online/id-scan/get-scan-groups/?"+s.A.add_token_as_parameter()},a=new i.A;return a.prepare_params(e).handle_response().catch((e=>{throw e}))}identity_flow_scan(e,a){let t={action_name:"identity-scan",method:"GET",url:(0,n.A)().endpoint_url()+"osmapi/identity-scan/"+(0,n.A)().get_session_token()+"/?"};t.url+="&serviceToken=veriface&scanGroupName="+e+"&identType="+a;let s=new i.A;return s.prepare_params(t).handle_response().catch((e=>{throw e}))}identity_flow_check(e){let a={action_name:"identity-scan-check",method:"GET",url:(0,n.A)().endpoint_url()+"osmapi/identity-scan-check/"+(0,n.A)().get_session_token()+"/?"};a.url+="&serviceToken=veriface&scanGroupName="+e;let t=new i.A;return t.prepare_params(a).handle_response().catch((e=>{throw e}))}identity_flow_refresh(){let e={action_name:"identity-scan-check",method:"GET",url:(0,n.A)().endpoint_url()+"osmapi/identity-scan-check/"+(0,n.A)().get_session_token()+"/?"};e.url+="&serviceToken=veriface";let a=new i.A;return a.prepare_params(e).handle_response().catch((e=>{throw e}))}}a.A=new o},4761:function(e,a,t){t.r(a),t.d(a,{default:function(){return x}});var n=t(641),s=t(33);const i={class:"row facial_scan"},o={class:"col-12 mb-5 mt-2"},r={class:"lead",style:{}},c={key:0,class:"col-12 col-sm-6 mb-5"},l={class:"fw-bold"},d={class:"fw-bold"},_=["href"],u={key:1},p={key:1,class:"col-12 col-sm-6 mb-5 d-none d-sm-block"},k=["src"],f={key:1,class:"qr_code placeholder"},h={key:2,class:"col-12"},m={class:"text-center"},v=["disabled"],b={key:3,class:"col-12 text-center mt-3",style:{"min-height":"19px"}},y={class:"col-12 mb-3"};function g(e,a,t,g,A,w){const j=(0,n.g2)("Bouncer_loading"),E=(0,n.g2)("Scan_feedback"),C=(0,n.g2)("Modal_body");return(0,n.uX)(),(0,n.Wv)(C,{close:!0,title:"op"===w.scan_type?"Naskenovanie dokladov":"Tvárová biometria",class:(0,s.C4)("op"===w.scan_type?"modal-credentials_scan":"modal-faceauth")},{default:(0,n.k6)((()=>[(0,n.Lk)("div",i,[(0,n.Lk)("div",o,[(0,n.Lk)("p",r,(0,s.v_)("op"===w.scan_type?"Pre bezpečné overenie Vašej osoby nahrajte prosím doklad totožnosti.":"Pre bezpečné overenie Vašej osoby potrebujeme porovnať doklad totožnosti s tvárovou biometriou."),1)]),A.already_done?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",c,[a[3]||(a[3]=(0,n.Lk)("p",null,"Pre spustenie overovania na tomto zariadení kliknite na link.",-1)),(0,n.Lk)("p",l,[A.veriface_link?((0,n.uX)(),(0,n.CE)("a",{key:0,onClick:a[0]||(a[0]=(...e)=>w.open_veriface_next_tab&&w.open_veriface_next_tab(...e)),href:"#"},(0,s.v_)(A.veriface_link),1)):(0,n.Q3)("",!0)]),a[4]||(a[4]=(0,n.Lk)("p",{class:"mt-5"},"Pre preposlanie emailom, kliknite na link.",-1)),(0,n.Lk)("p",d,[A.veriface_link?((0,n.uX)(),(0,n.CE)("a",{key:0,href:w.mail_sample}," Skopírovať do emailového klienta. ",8,_)):((0,n.uX)(),(0,n.CE)("span",u,"Načítavam..."))])])),A.already_done?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",p,[a[5]||(a[5]=(0,n.Lk)("p",null,"Pre spustenie overovania na mobilnom zariadení, načítajte QR kód.",-1)),A.veriface_qr?((0,n.uX)(),(0,n.CE)("img",{key:0,src:A.veriface_qr,class:"qr_code"},null,8,k)):((0,n.uX)(),(0,n.CE)("div",f))])),A.already_done?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",h,[a[6]||(a[6]=(0,n.Lk)("ul",{class:"mb-4"},[(0,n.Lk)("li",{class:"mb-0"},"Okno nezatvárajte."),(0,n.Lk)("li",{class:"mb-0"},"Postupujte podľa pokynov v aplikácii overovania."),(0,n.Lk)("li",{class:"mb-0"},'Keď proces úspešne dokončíte kliknite na tlačidlo "Skontrolovať stav".')],-1)),(0,n.Lk)("div",m,[(0,n.Lk)("button",{onClick:a[1]||(a[1]=(...e)=>w.face_check&&w.face_check(...e)),disabled:A.loading,class:"btn btn-primary"}," Skontrolovať stav ",8,v),A.manual_close_button?((0,n.uX)(),(0,n.CE)("button",{key:0,onClick:a[2]||(a[2]=(...e)=>w.close_the_face&&w.close_the_face(...e)),class:"btn btn-primary ms-1"}," Validate ")):(0,n.Q3)("",!0)])])),A.already_done?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",b,[A.loading?((0,n.uX)(),(0,n.Wv)(j,{key:0})):(0,n.Q3)("",!0)])),(0,n.Lk)("div",y,[(0,n.bF)(E,{feedback:A.feedback},null,8,["feedback"])])])])),_:1},8,["title","class"])}t(4114);var A=t(8384),w=t(2873),j=t(55),E=t(6884),C=t(6460),N=t(3177),T=t(9614),L=t(7406),S=t(8700),O={props:{},components:{Modal_body:A.A,Bouncer_loading:j.A,Scan_feedback:L.A},emits:[],data(){return{debug:!0,loading:!0,already_done:!1,veriface_link:"",veriface_qr:"",success_object:{},feedback:[],manual_close_button:!1}},created(){this.debug&&(this.add_feedback("DEBUG ON."),this.add_feedback("scanGroupName : "+this.facial_input_token)),this.face_init()},methods:{face_init(){if("1"===(0,N.A)().get_form_value(this.facial_input_token))return this.add_feedback("Skenovanie dokumentov je úspešne ukončené."),void(this.already_done=!0);this.loading=!0,this.common_api?E.A.identity_scan(this.facial_input_token,this.scan_type).then((e=>{this.loading=!1,200===e.status?(this.veriface_link=e.result?.data?.url,this.veriface_qr=e.result?.data?.base64png?"data:image/png;base64,"+e.result?.data?.base64png:""):this.add_feedback(JSON.stringify(e.result.message))})):E.A.identity_flow_scan(this.facial_input_token,this.scan_type).then((e=>{this.loading=!1,200===e.status?(this.veriface_link=e.result?.data?.resultData?.data?.url,this.veriface_qr=e.result?.data?.resultData?.data?.base64png?"data:image/png;base64,"+e.result?.data?.resultData?.data?.base64png:""):this.add_feedback(JSON.stringify(e.result.message))}))},face_check(){this.loading=!0,this.common_api?E.A.identity_check(this.facial_input_token).then((e=>{if(this.loading=!1,200===e.status){if("object"!==typeof e.result.data||Object.keys(e.result.data).length<=0)return this.add_feedback("Dáta v nesprávnom formáte."),void this.add_feedback(JSON.stringify(e.result));this.add_feedback("Overovanie bolo úspešné."),this.success_object=e.result.data,this.face_fill()}else this.add_feedback(JSON.stringify(e.result.message))})):E.A.identity_flow_check(this.facial_input_token).then((e=>{if(this.loading=!1,200===e.status)if("processing"!==e.result.data?.resultData?.["scan-status"]){if("verified"!==e.result.data?.resultData?.["scan-status"])return this.add_feedback("Neočakávaný stav overovania."),void this.add_feedback(JSON.stringify(e.result.data));if(this.add_feedback("Overovanie bolo úspešné."),"object"!==typeof e.result.data?.resultData?.data||Object.keys(e.result.data?.resultData?.data).length<=0)return this.add_feedback("Dáta v nesprávnom formáte."),void this.add_feedback(JSON.stringify(e.result));this.success_object=e.result.data?.resultData?.data,this.face_fill()}else this.add_feedback("Overovanie ešte neprebehlo.");else this.add_feedback(JSON.stringify(e.result.message))}))},face_fill(){this.add_feedback("Ukladáme Vaše údaje."),(0,N.A)().set_form_value(this.facial_input_token,"1"),(0,C.A)().clear_one_error(this.facial_input_token);let e=this.facial_settings?.prefix||"",a=this.facial_settings?.suffix||"";if((0,N.A)().set_multiple_form_values(this.success_object,e,a),this.debug)return this.add_feedback(JSON.stringify(this.success_object)),this.add_feedback('PREFIX: "'+e+'"'),this.add_feedback('SUFFIX: "'+a+'"'),this.add_feedback('Automatické vyplnenie formuláru je vypnuté. Kliknite na "VALIDATE"'),void(this.manual_close_button=!0);setTimeout((()=>{this.close_the_face()}),3e3)},close_the_face(){(0,w.A)().close_them_all(),(0,T.A)().set_requested_direction("forward")},open_veriface_next_tab(e){e.preventDefault(),window.open(this.veriface_link,"_blank").focus()},add_feedback(e){this.feedback.push(e)}},computed:{facial_input_token(){return(0,w.A)().retrieve_modal_data().field_id},facial_settings(){return(0,w.A)().retrieve_modal_data().data_fill},scan_type(){return(0,w.A)().retrieve_modal_data().scan_type},common_api(){return"form_app"===(0,S.A)().get_run_mode()},mail_sample(){let e=encodeURIComponent("Tvárová biometria"),a=encodeURIComponent("Dobrý deň, \n\r zasielame Vám link pre overenie totožnosti: \n\r\n\r "+this.veriface_link+" \n\r\n\r S pozdravom \n\r");return"mailto:?subject="+e+"&body="+a}},watch:{}},D=t(6262);const X=(0,D.A)(O,[["render",g]]);var x=X}}]);