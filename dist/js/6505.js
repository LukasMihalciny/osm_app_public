"use strict";(self["webpackChunkosmapp_webpack_3x47x"]=self["webpackChunkosmapp_webpack_3x47x"]||[]).push([[6505],{55:function(e,a,t){t.d(a,{A:function(){return d}});var i=t(641),n=t(33);const s={class:"spinner"};function o(e,a,t,o,c,r){return(0,i.uX)(),(0,i.CE)("div",s,[(0,i.Lk)("div",{class:(0,n.C4)(["bounce1",t.size])},null,2),(0,i.Lk)("div",{class:(0,n.C4)(["bounce2",t.size])},null,2),(0,i.Lk)("div",{class:(0,n.C4)(["bounce3",t.size])},null,2)])}var c={props:{size:String},components:{},data(){return{}},created(){},methods:{},computed:{}},r=t(6262);const l=(0,r.A)(c,[["render",o]]);var d=l},2563:function(e,a,t){t.d(a,{A:function(){return p}});var i=t(641),n=t(33);const s={class:"modal-content","data-cy":"modal_content"},o={class:"modal-header"},c={class:"modal-body","data-cy":"modal_body"};function r(e,a,t,r,l,d){return(0,i.uX)(),(0,i.CE)("div",{onClick:a[1]||(a[1]=(...e)=>d.did_click_outside&&d.did_click_outside(...e)),class:(0,n.C4)(["vue_modal",t.modal_size]),"data-cy":"modal"},[(0,i.Lk)("div",s,[(0,i.Lk)("div",o,[t.icon?((0,i.uX)(),(0,i.CE)("span",{key:0,class:(0,n.C4)(["modal-icon",t.icon])},null,2)):(0,i.Q3)("",!0),(0,i.Lk)("h4",null,(0,n.v_)(t.title),1),t.close?((0,i.uX)(),(0,i.CE)("span",{key:1,onClick:a[0]||(a[0]=(...e)=>d.close_me&&d.close_me(...e)),class:"i_close"})):(0,i.Q3)("",!0)]),(0,i.Lk)("div",c,[(0,i.RG)(e.$slots,"default")])])],2)}var l=t(2873),d={props:{close:Boolean,title:String,modal_size:String,icon:{type:String}},components:{},emits:[],data(){return{}},created(){document.addEventListener("keyup",this.close_me)},beforeUnmount(){document.removeEventListener("keyup",this.close_me)},methods:{close_me(e){this.close&&("click"===e?.type||"keyup"===e?.type&&27===e?.keyCode)&&(0,l.A)().close_them_all()},did_click_outside(e){e.target.classList.contains("vue_modal")&&this.close_me(e)}},computed:{},watch:{}},_=t(6262);const u=(0,_.A)(d,[["render",r]]);var p=u},6505:function(e,a,t){t.r(a),t.d(a,{default:function(){return Z}});var i=t(641),n=t(33);const s={class:"row facial_scan"},o={key:0,class:"col-12 lead"},c={key:1,class:"col-12 col-sm-6 mb-5"},r={key:0,class:"scan-option"},l={class:"scan-option-text"},d={key:1},_={class:"scan-option"},u={class:"scan-option-text"},p={class:"fw-bold"},k={key:0},v={key:1},f={key:2,class:"col-12 col-sm-6 mb-5 d-none d-sm-block"},m={class:"scan-option"},h={class:"scan-option-text"},b=["src"],y={key:1,class:"qr_code placeholder"},g={key:3,class:"col-12"},L={key:0,class:"mb-4 dots-accent"},w={key:1,class:"mb-5 no-dots"},A={class:"text-center"},E=["disabled"],C={key:4,class:"col-12"},S={class:"col-12 text-center mt-3",style:{"min-height":"19px"}},X={class:"col-12 mb-3"};function x(e,a,t,x,z,T){const O=(0,i.g2)("Veriface_iframe"),N=(0,i.g2)("Bouncer_loading"),j=(0,i.g2)("Scan_feedback"),P=(0,i.g2)("Modal_body");return(0,i.uX)(),(0,i.Wv)(P,{close:z.allow_closing&&!z.loading,title:T.scan_modal_title,class:(0,n.C4)("op"===T.scan_type?"modal-credentials_scan":"modal-faceauth"),modal_size:"medium",icon:"i_faceauth"},{default:(0,i.k6)(()=>[(0,i.Lk)("div",s,[z.load_iframe?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("div",o,[(0,i.Lk)("p",null,(0,n.v_)(T.scan_modal_subtitle),1),a[3]||(a[3]=(0,i.Lk)("p",null," Vyberte si jednu z možností: ",-1))])),z.load_iframe?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("div",c,[T.client_present?((0,i.uX)(),(0,i.CE)("div",r,[a[6]||(a[6]=(0,i.Lk)("span",{class:"scan-option-label"},"A)",-1)),(0,i.Lk)("div",l,[a[5]||(a[5]=(0,i.Lk)("p",null,[(0,i.eW)(" Pre spustenie overovania na "),(0,i.Lk)("b",null,"tomto zariadení"),(0,i.eW)(" kliknite na link. ")],-1)),(0,i.Lk)("p",null,[z.veriface_link?((0,i.uX)(),(0,i.CE)("a",{key:0,onClick:a[0]||(a[0]=(...e)=>T.switch_to_iframe&&T.switch_to_iframe(...e)),href:"#",class:"fw-bold"},[...a[4]||(a[4]=[(0,i.Lk)("span",{class:"fw-bold"},"Otvoriť identifikáciu - overovanie",-1),(0,i.eW)(" (odporúčané)",-1)])])):((0,i.uX)(),(0,i.CE)("span",d,"Načítavam..."))])])])):(0,i.Q3)("",!0),(0,i.Lk)("div",_,[a[8]||(a[8]=(0,i.Lk)("span",{class:"scan-option-label"},"B)",-1)),(0,i.Lk)("div",u,[a[7]||(a[7]=(0,i.Lk)("p",null,[(0,i.eW)(" Pre preposlanie "),(0,i.Lk)("b",null,"ľubovolným spôsobom"),(0,i.eW)(", skopírujte link. ")],-1)),(0,i.Lk)("p",p,[z.veriface_link?((0,i.uX)(),(0,i.CE)("span",k,[(0,i.eW)((0,n.v_)(z.veriface_link)+" ",1),(0,i.Lk)("a",{onClick:a[1]||(a[1]=(...e)=>T.to_clipboard&&T.to_clipboard(...e)),href:"#",class:"position-absolute"},[(0,i.Lk)("span",{class:(0,n.C4)(["i_clipboard",z.clipboard_helper?"i_clipboard_success":""])},null,2)])])):((0,i.uX)(),(0,i.CE)("span",v,"Načítavam..."))])])])])),!z.load_iframe&&T.client_present?((0,i.uX)(),(0,i.CE)("div",f,[(0,i.Lk)("div",m,[a[10]||(a[10]=(0,i.Lk)("span",{class:"scan-option-label"},"C)",-1)),(0,i.Lk)("div",h,[a[9]||(a[9]=(0,i.Lk)("p",null,[(0,i.eW)(" Pre spustenie overovania na "),(0,i.Lk)("b",null,"mobilnom zariadení"),(0,i.eW)(", načítajte QR kód. ")],-1)),z.veriface_qr?((0,i.uX)(),(0,i.CE)("img",{key:0,src:"data:image/png;base64,"+z.veriface_qr,class:"qr_code"},null,8,b)):((0,i.uX)(),(0,i.CE)("div",y))])])])):(0,i.Q3)("",!0),z.load_iframe?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("div",g,[a[13]||(a[13]=(0,i.Lk)("h6",{class:"text-primary fw-bold"},"Návod ako postupovať:",-1)),"op"===T.scan_type?((0,i.uX)(),(0,i.CE)("ul",L,[...a[11]||(a[11]=[(0,i.Lk)("li",{class:"mb-0"},"Okno nezatvárajte.",-1),(0,i.Lk)("li",{class:"mb-0"},"Pripravte si doklad totožnosti.",-1),(0,i.Lk)("li",{class:"mb-0"},"Otvorte aplikáciu overovania na Vami preferovanom zariadení.",-1),(0,i.Lk)("li",{class:"mb-0"},"Postupujte podľa pokynov v aplikácii overovania.",-1),(0,i.Lk)("li",{class:"mb-0"},'Keď proces úspešne dokončíte, kliknite na tlačidlo "Skontrolovať stav".',-1)])])):((0,i.uX)(),(0,i.CE)("ul",w,[...a[12]||(a[12]=[(0,i.Lk)("li",{class:"mb-0"},[(0,i.Lk)("span",{class:"text-accent fw-bold"},"1."),(0,i.eW)(" Nezatvárajte toto dialógové okno.")],-1),(0,i.Lk)("li",{class:"mb-0"},[(0,i.Lk)("span",{class:"text-accent fw-bold"},"2."),(0,i.eW)(" Otvorte aplikáciu overovania na Vami preferovanom zariadení.")],-1),(0,i.Lk)("li",{class:"mb-0"},[(0,i.Lk)("span",{class:"text-accent fw-bold"},"3."),(0,i.eW)(" Celé overenie musí prebiehať v reálnom čase na jednom zariadení.")],-1),(0,i.Lk)("li",{class:"mb-0"},[(0,i.Lk)("span",{class:"text-accent fw-bold"},"4."),(0,i.eW)(" Postupujte podľa pokynov a aplikácii.")],-1),(0,i.Lk)("li",{class:"mb-0"},[(0,i.Lk)("span",{class:"text-accent fw-bold"},"5."),(0,i.eW)(" Nahrávanie dokladu a snímka tváre musí prebiehať v reálnom čase a konzistentne:")],-1),(0,i.Lk)("ul",{class:"mb-0 dots-accent"},[(0,i.Lk)("li",{class:"mb-0"},"snímka 1. strany dokladu"),(0,i.Lk)("li",{class:"mb-0"},"snímka 2. strany dokladu"),(0,i.Lk)("li",{class:"mb-0"},"snímka tváre")],-1),(0,i.Lk)("li",{class:"mb-0"},[(0,i.Lk)("span",{class:"text-accent fw-bold"},"6."),(0,i.eW)(' Keď proces úspešne dokončíte, kliknite na tlačidlo "Skontrolovať stav".')],-1)])])),(0,i.Lk)("div",A,[(0,i.Lk)("button",{onClick:a[2]||(a[2]=(...e)=>T.face_check&&T.face_check(...e)),disabled:z.loading,class:"btn btn-primary"}," Skontrolovať stav ",8,E)])])),z.load_iframe?((0,i.uX)(),(0,i.CE)("div",C,[(0,i.bF)(O,{veriface_link:z.veriface_link,onVeriface_closing:T.veriface_closing},null,8,["veriface_link","onVeriface_closing"])])):(0,i.Q3)("",!0),(0,i.Lk)("div",S,[z.loading?((0,i.uX)(),(0,i.Wv)(N,{key:0})):(0,i.Q3)("",!0)]),(0,i.Lk)("div",X,[(0,i.bF)(j,{feedback:z.feedback},null,8,["feedback"])])])]),_:1},8,["close","title","class"])}t(4114),t(3110);var z=t(2563),T=t(2873),O=t(55),N=t(6884),j=t(6460),P=t(3177),U=t(9614),W=t(3751);const D={class:"scan_feedback"};function V(e,a,t,s,o,c){return(0,i.bo)(((0,i.uX)(),(0,i.CE)("p",D,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(t.feedback,e=>((0,i.uX)(),(0,i.CE)("span",null,[(0,i.eW)((0,n.v_)(e),1),a[0]||(a[0]=(0,i.Lk)("br",null,null,-1))]))),256))],512)),[[W.aG,t.feedback.length>0]])}var G={props:{feedback:Array},components:{},emits:[],data(){return{}},created(){},methods:{},computed:{},watch:{}},Q=t(6262);const q=(0,Q.A)(G,[["render",V]]);var I=q,F=t(8700),R=t(5143);const B=["src"];function K(e,a,t,s,o,c){return(0,i.uX)(),(0,i.CE)("iframe",{src:t.veriface_link+"&embedded=true",allow:"camera;microphone",scrolling:"no",style:(0,n.Tr)([{width:"100%",transition:"all .5s","min-height":"300px",overflow:"none"},{height:o.height+"px"}])},null,12,B)}var J={props:{veriface_link:String},components:{},emits:["veriface_closing"],data(){return{height:300}},created(){window.addEventListener("message",this.listen_to_veriface)},beforeUnmount(){window.removeEventListener("message",this.listen_to_veriface)},methods:{listen_to_veriface(e){"https://app.veriface.eu"===e.origin&&("height"===e.data.action?this.height=Math.round(e.data.value):"close"===e.data.action&&this.$emit("veriface_closing",e.data.result))}},computed:{},watch:{}};const M=(0,Q.A)(J,[["render",K]]);var $=M,H={props:{},components:{Modal_body:z.A,Bouncer_loading:O.A,Scan_feedback:I,Veriface_iframe:$},emits:[],data(){return{debug:!1,loading:!0,allow_closing:!0,veriface_link:"",veriface_qr:"",feedback:[],load_iframe:!1,clipboard_helper:!1,check_attempt:0,check_max:10,check_delay:1e4}},created(){this.debug&&(this.add_feedback("DEBUG ON."),this.add_feedback("scanGroupName: "+this.facial_input_token)),this.face_init(!1)},methods:{face_init(e){this.veriface_link="",this.veriface_qr="",this.loading=!0,Promise.resolve().then(()=>this.common_api?N.A.identity_scan(e,this.facial_input_token,this.scan_type):N.A.identity_flow_scan(e,this.facial_input_token,this.scan_type,this.flow_action_id)).then(e=>{let a=!1;if(this.loading=!1,200!==e.status)return this.add_feedback("Aktivácia overovania zlyhala."),void this.add_feedback(JSON.stringify(e.result?.message));this.common_api?(this.veriface_link=e.result?.data?.url,this.veriface_qr=e.result?.data?.base64png,a=e.result?.data?.newScanId||!1):(this.veriface_link=e.result?.data?.resultData?.data?.url,this.veriface_qr=e.result?.data?.resultData?.data?.base64png,a=e.result?.data?.resultData?.data?.newScanId||!1),a||this.face_check()})},face_check(){if(this.load_iframe=!1,this.loading=!0,this.check_attempt++,this.check_attempt>this.check_max)return this.add_feedback("Dosiahnuté maximálne množstvo pokusov. Vyskúšajte znovu alebo kontaktujte technickú podporu."),this.loading=!1,void(this.check_attempt=0);Promise.resolve().then(()=>this.common_api?N.A.identity_check(this.facial_input_token):N.A.identity_flow_check(this.facial_input_token,this.flow_action_id)).then(e=>{if(200!==e.status)return this.add_feedback("Kontrola overovania zlyhala."),void this.add_feedback(JSON.stringify(e.result?.message));this.common_api?this.face_fill(e.result):this.face_fill(e.result?.data?.resultData)})},face_fill(e){if(console.log(e?.["scan-status"],e?.["provider-info"]?.status,e?.["provider-info"]?.verificationEndUserStatus,e?.messages),"object"===typeof e?.messages&&null!==e?.messages&&Object.keys(e?.messages).length>0)for(let i in e?.messages)e?.messages[i]&&this.add_feedback(e?.messages[i]);if("UNSTARTED"===e?.["provider-info"]?.verificationEndUserStatus)return this.add_feedback("Proces overenia zatiaľ nebol spustený."),this.loading=!1,void(this.check_attempt=0);if("NOT_FINISHED"===e?.["provider-info"]?.verificationEndUserStatus)return this.add_feedback("Overovanie ešte prebieha."),this.loading=!1,void(this.check_attempt=0);if("SUCCESS"===e?.["provider-info"]?.verificationEndUserStatus)this.add_feedback("Overovanie úspešné. Kontrolujeme dokumenty.");else{if("FAILURE"===e?.["provider-info"]?.verificationEndUserStatus)return this.add_feedback("Overovanie nebolo úspešné. Vyžiadame nové overovanie."),this.check_attempt=0,void this.face_init(!0);if("CANCELLED"===e?.["provider-info"]?.verificationEndUserStatus)return this.add_feedback("Overovanie bolo zrušené užívatelom. Vyžiadame nové overovanie."),this.check_attempt=0,void this.face_init(!0);if("EXPIRED"===e?.["provider-info"]?.verificationEndUserStatus)return this.add_feedback("Overovací proces nebol dokončený včas. Vyžiadame nové overovanie."),this.check_attempt=0,void this.face_init(!0);if("POSTPONED"===e?.["provider-info"]?.verificationEndUserStatus)return this.add_feedback("Overovanie bolo dočasne pozdržané."),this.loading=!1,void(this.check_attempt=0)}if("not_found"===e?.["scan-status"])return this.add_feedback("Overovací proces expiroval. Vyžiadame nové overovanie."),this.check_attempt=0,void this.face_init(!0);if("verified"!==e?.["scan-status"])return void setTimeout(()=>{this.veriface_closing("internal_repeat")},this.check_delay);if(this.loading=!1,"object"!==typeof e?.data||Object.keys(e?.data).length<=0)return this.add_feedback("Dáta v nesprávnom formáte."),void this.add_feedback(JSON.stringify(e));this.add_feedback("Dokumenty sú v poriadku. Ukladáme Vaše údaje."),(0,P.A)().set_form_value(this.facial_input_token,(0,F.A)().get_session_token()),(0,j.A)().clear_one_error(this.facial_input_token);let a=this.facial_settings?.prefix||"",t=this.facial_settings?.suffix||"";(0,P.A)().set_multiple_form_values(e?.data,a,t),this.debug&&(this.add_feedback(JSON.stringify(e?.data)),this.add_feedback('PREFIX: "'+a+'"'),this.add_feedback('SUFFIX: "'+t+'"')),setTimeout(()=>{(0,T.A)().close_them_all(),(0,U.A)().set_requested_direction("forward")},3e3)},veriface_closing(e){console.log("veriface",e),"SUCCESS"===e||"internal_repeat"===e?this.face_check():(0,T.A)().close_them_all()},add_feedback(e){this.feedback.push(e)},switch_to_iframe(e){e.preventDefault(),this.load_iframe=!0,this.allow_closing=!1},to_clipboard(e){e.preventDefault(),navigator.clipboard.writeText(this.veriface_link),this.clipboard_helper=!0,setTimeout(()=>{this.clipboard_helper=!1},3e3)}},computed:{facial_input_token(){return(0,T.A)().retrieve_modal_data().field_id},facial_settings(){return(0,T.A)().retrieve_modal_data().data_fill},scan_type(){return(0,T.A)().retrieve_modal_data().scan_type},client_present(){return"abc"===(0,T.A)().retrieve_modal_data().user_presence},flow_action_id(){if(this.common_api)return null;let e=(0,R.A)().get_workflow_actions();for(let a in e)if("identityScan"===e[a]?.function&&e[a]?.functionParams?.identToken===this.facial_input_token)return e[a].id;return null},common_api(){return"form_app"===(0,F.A)().get_run_mode()},is_nodered(){return"node_red"===(0,F.A)().get_run_mode()},scan_modal_title(){return"op"===this.scan_type?"Naskenovanie dokladov":this.is_nodered?"Tvárová biometria":"Overenie totožnosti"},scan_modal_subtitle(){return this.is_nodered?"op"===this.scan_type?"Pre bezpečné overenie Vašej osoby, prosím nahrajte fotku dokladu totožnosti.":"Pre bezpečné overenie Vašej osoby, porovnáme doklad totožnosti s tvárovou biometriou.":"op"===this.scan_type?"Pre bezpečné overenie totožnosti klienta, prosím nahrajte fotku dokladu totožnosti.":"Pre bezpečné overenie totožnosti klienta, porovnáme doklad totožnosti s tvárovou biometriou."}},watch:{}};const Y=(0,Q.A)(H,[["render",x]]);var Z=Y},6884:function(e,a,t){var i=t(8700),n=t(6343),s=t(3175);class o{identity_scan(e,a,t){let o={action_name:"identity-scan",method:"GET",url:(0,i.A)().endpoint_url()+"online/identity-scan/?"+n.A.add_token_as_parameter()};o.url+="&serviceToken=veriface&scanGroupName="+a+"&identType="+t+"&identNew="+(e?"true":"false");let c=new s.A;return c.prepare_params(o).handle_response().catch(e=>{throw e})}identity_check(e){let a={action_name:"identity-scan-check",method:"GET",url:(0,i.A)().endpoint_url()+"online/identity-scan-check/?"+n.A.add_token_as_parameter()};a.url+="&serviceToken=veriface&scanGroupName="+e;let t=new s.A;return t.prepare_params(a).handle_response().catch(e=>{throw e})}identity_refresh(){let e={action_name:"id-scan/get-scan-groups",method:"GET",url:(0,i.A)().endpoint_url()+"api/online/id-scan/get-scan-groups/?"+n.A.add_token_as_parameter()},a=new s.A;return a.prepare_params(e).handle_response().catch(e=>{throw e})}identity_flow_scan(e,a,t,n){let o={action_name:"identity-scan",method:"GET",url:(0,i.A)().endpoint_url()+"osmapi/identity-scan/"+(0,i.A)().get_session_token()+"/?"};o.url+="serviceToken=veriface&identToken="+a+"&identType="+t+"&action-id="+n+"&identNew="+(e?"true":"false");let c=new s.A;return c.prepare_params(o).handle_response().catch(e=>{throw e})}identity_flow_check(e,a){let t={action_name:"identity-scan-check",method:"GET",url:(0,i.A)().endpoint_url()+"osmapi/identity-scan-check/"+(0,i.A)().get_session_token()+"/?"};t.url+="serviceToken=veriface&identToken="+e+"&action-id="+a;let n=new s.A;return n.prepare_params(t).handle_response().catch(e=>{throw e})}identity_flow_refresh(){let e={action_name:"identity-scan-check",method:"GET",url:(0,i.A)().endpoint_url()+"osmapi/identity-scan-check/"+(0,i.A)().get_session_token()+"/?"};e.url+="serviceToken=veriface";let a=new s.A;return a.prepare_params(e).handle_response().catch(e=>{throw e})}}a.A=new o}}]);