"use strict";(self["webpackChunkosmapp_webpack_3x25x"]=self["webpackChunkosmapp_webpack_3x25x"]||[]).push([[873],{55:function(e,t,n){n.d(t,{A:function(){return c}});var s=n(641),o=n(33);const a={class:"spinner"};function r(e,t,n,r,i,_){return(0,s.uX)(),(0,s.CE)("div",a,[(0,s.Lk)("div",{class:(0,o.C4)(["bounce1",n.size])},null,2),(0,s.Lk)("div",{class:(0,o.C4)(["bounce2",n.size])},null,2),(0,s.Lk)("div",{class:(0,o.C4)(["bounce3",n.size])},null,2)])}var i={props:{size:String},components:{},data(){return{}},created(){},methods:{},computed:{}},_=n(6262);const l=(0,_.A)(i,[["render",r]]);var c=l},3367:function(e,t,n){n.d(t,{A:function(){return g}});var s=n(641),o=n(3751);const a={class:"row mt-4 form-pagination","data-cy":"navigation"},r={class:"col-12 col-sm-4 text-center text-sm-start order-2 order-sm-1"},i={class:"col-12 col-sm-4 text-center order-3 order-sm-2"},_={class:"col-12 col-sm-4 text-center text-sm-end order-1 order-sm-3"},l=["disabled","title"];function c(e,t,n,c,p,u){const d=(0,s.g2)("Bouncer_loading");return(0,s.uX)(),(0,s.CE)("div",a,[(0,s.Lk)("div",r,[n.show_back?((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:t[0]||(t[0]=(...e)=>u.prev&&u.prev(...e)),type:"button",class:"btn btn-light btn-left btn-lg"}," Naspäť ")):(0,s.Q3)("",!0)]),(0,s.Lk)("div",i,[(0,s.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>u.clear&&u.clear(...e)),type:"button",class:"btn btn-white btn-lg"}," Vymazať údaje ")]),(0,s.Lk)("div",_,[(0,s.bo)((0,s.bF)(d,null,null,512),[[o.aG,u.loading]]),n.show_next?(0,s.bo)(((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:t[2]||(t[2]=(...e)=>u.next&&u.next(...e)),disabled:n.disable_next,title:n.disable_next?"Pokúšame sa zopakovať požiadavku.":"",type:"button",class:"btn btn-primary btn-right btn-lg"}," Pokračovať ",8,l)),[[o.aG,!u.loading]]):(0,s.Q3)("",!0)])])}var p=n(55),u=n(2873),d={props:{show_back:Boolean,show_next:Boolean,disable_next:Boolean},components:{Bouncer_loading:p.A},emits:["next","prev"],data(){return{}},created(){},methods:{next(){this.$emit("next")},prev(){this.$emit("prev")},clear(){(0,u.A)().open_it("Cleaning_session")}},computed:{loading(){return(0,u.A)().is_loading()}}},m=n(6262);const h=(0,m.A)(d,[["render",c]]);var g=h},7654:function(e,t,n){var s=n(8700),o=n(6343),a=n(3175),r=n(5833),i=n(6460);class _{confirm_session(e){let t="";e&&(t=(0,i.A)().get_confirm_chbs(),t=o.A.serialize_object(t));let n={action_name:"confirm",method:"GET",url:(0,s.A)().endpoint_url()+"online/confirm/?"+t+o.A.add_token_as_parameter()},r=new a.A;return r.prepare_params(n).handle_response().then(e=>408===e.status||412===e.status?this.repeat_getsessioninfo(0):e).catch(e=>{throw e})}repeat_confirm(){let e={action_name:"confirm",method:"GET",url:(0,s.A)().endpoint_url()+"online/confirm/?"+o.A.add_token_as_parameter()},t=new a.A;return t.prepare_params(e).handle_response().catch(e=>{throw e})}async repeat_getsessioninfo(e){e++;let t=10,n=10;console.log("wait "+n+" seconds then try getsessioninfo, iteration: "+e+" (max "+t+")"),await o.A.sleep(n);let i={action_name:"getsessioninfo",method:"GET",url:(0,s.A)().endpoint_url()+"online/getsessioninfo/?"+o.A.add_token_as_parameter()},_=new a.A;return _.prepare_params(i).handle_response().then(n=>{if(100===n.result?.state)return n;if(e>=t){let e=(new Date).toLocaleString(),t=(0,s.A)().get_session_token(),o=(0,s.A)().current_step();return(0,r.A)().set_last_request({},i,e,t,o,n),(0,s.A)().set_overseer_view(404),{status:408,action_name:"getsessioninfo"}}return this.repeat_getsessioninfo(e)}).catch(e=>{throw e})}}t.A=new _},8873:function(e,t,n){n.r(t),n.d(t,{default:function(){return E}});var s=n(641),o=n(33);const a={"data-cy":"error_page"},r={class:"text-center pt-5"},i={key:0},_={class:"text-primary"},l={class:"text-primary"},c={class:"mb-5"},p={key:1,class:"text-center"};function u(e,t,n,u,d,m){const h=(0,s.g2)("Navigation");return(0,s.uX)(),(0,s.CE)("section",a,[(0,s.Lk)("div",r,[t[2]||(t[2]=(0,s.Lk)("h1",null," Ľutujeme, niečo sa nepodarilo :( ",-1)),t[3]||(t[3]=(0,s.Lk)("p",null,[(0,s.eW)(" Vyskytla sa neočakávaná chyba, preto nebolo možné dokončiť operáciu."),(0,s.Lk)("br"),(0,s.eW)(" Pre informácie ohľadom ďalšieho postupu nás prosím kontaktujte. ")],-1)),m.phone?((0,s.uX)(),(0,s.CE)("div",i,[(0,s.Lk)("h3",_,(0,o.v_)(m.phone),1),t[1]||(t[1]=(0,s.Lk)("p",null," Volajte kedykoľvek pondelok až piatok 09:00 - 17:00 ",-1))])):(0,s.Q3)("",!0),(0,s.Lk)("h3",l,(0,o.v_)(m.email),1),t[4]||(t[4]=(0,s.Lk)("p",null," Pošlite nám fotku tejto obrazovky a ozveme sa vám. ",-1))]),(0,s.Lk)("pre",c,(0,o.v_)(m.error),1),m.form_app_mode?((0,s.uX)(),(0,s.Wv)(h,{key:0,onPrev:m.prev_button,onNext:m.next_button,show_back:!0,show_next:!0,disable_next:d.disable_next},null,8,["onPrev","onNext","disable_next"])):(0,s.Q3)("",!0),m.form_app_mode?((0,s.uX)(),(0,s.CE)("div",p,[(0,s.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>m.open_where&&m.open_where(...e)),class:"btn btn-outline-primary mt-5"}," Zotavenie session ")])):(0,s.Q3)("",!0)])}var d=n(3367),m=n(5833),h=n(9819),g=n(8700),f=n(9452),k=n(7654),A=n(2873),b=(n(3110),n(6343),n(3175)),v=n(3177);class w{grafana(){let e=(0,m.A)().get_detailed_fail(),t={message:"osmapp: "+e.action_name+" failed",level_name:"DEBUG",type:"frontend",context:{failed_api:e,app_state:{version:(0,g.A)().give_app_version(),session_token:(0,g.A)().get_session_token(),endpoint_type:(0,g.A)().get_endpoint_type(),run_mode:(0,g.A)().get_run_mode(),backend_type:(0,g.A)().get_backend_type(),group_id:(0,g.A)().product_group_id(),step:e.step,flow_id:(0,g.A)().get_flow_id(),signature_role:(0,g.A)().get_signature_role(),payment:(0,g.A)().get_payment_data(),representative:(0,g.A)().get_representative(),agent_code:(0,v.A)().get_agent_code(),selected_product:(0,v.A)().get_selected_product()}},request_uri:window.location.href,module_fqdn:window.location.hostname},n={action_name:"logger",method:"POST",body:JSON.stringify(t),url:(0,g.A)().grafana_url(),content_type:"application/json"},s=new b.A;return s.prepare_params(n).handle_response().catch(e=>{throw e})}}var x=new w,y={props:{},components:{Navigation:d.A},emits:[],data(){return{session_state:0,disable_next:!0,attempt:0,timeout_handle:"",fast_tries:1,slow_tries:2,last_tries:1,fast_timer:10,slow_timer:20,last_timer:50}},created(){x.grafana(),this.set_continue_timer()},beforeUnmount(){clearTimeout(this.timeout_handle)},methods:{prev_button(){clearTimeout(this.timeout_handle),(0,g.A)().change_step(this.error.step)},next_button(){100!==this.session_state?k.A.repeat_confirm().then(e=>{"success"!==e.result?.response&&100!==e.result?.state||(0,g.A)().change_step(5)}):(0,g.A)().change_step(5)},set_continue_timer(){if(!this.form_app_mode)return;if(this.attempt++,this.attempt>this.fast_tries+this.slow_tries+this.last_tries)return void console.log("continue_session reached max tries");let e=this.attempt>this.fast_tries+this.slow_tries?this.last_timer:this.attempt>this.fast_tries?this.slow_timer:this.fast_timer;e*=1e3,this.timeout_handle=setTimeout(()=>{this.continue_session()},e)},continue_session(){f.A.session_info().then(e=>{200===e.status?"success"===e.result?.response||100===e.result?.state?(this.session_state=100,this.disable_next=!1):90===e.result?.state?(this.session_state=90,this.disable_next=!1):this.set_continue_timer():console.log("getsessioninfo failed")})},open_where(){clearTimeout(this.timeout_handle),(0,A.A)().open_it("Resurrect_session")}},computed:{error(){return(0,m.A)().get_last_request()},email(){return h.A.email_address()},phone(){return h.A.phone_number()},form_app_mode(){return"form_app"===(0,g.A)().get_run_mode()}},watch:{}},L=n(6262);const C=(0,L.A)(y,[["render",u]]);var E=C},9452:function(e,t,n){var s=n(8700),o=n(6343),a=n(3175);class r{session_info(){let e={action_name:"getsessioninfo",method:"GET",url:(0,s.A)().endpoint_url()+"online/getsessioninfo/?"+o.A.add_token_as_parameter()},t=new a.A;return t.prepare_params(e).handle_response().catch(e=>{throw e})}get_data(){let e={action_name:"getdata",method:"GET",url:(0,s.A)().endpoint_url()+"online/getdata/?"+o.A.add_token_as_parameter()},t=new a.A;return t.prepare_params(e).handle_response().catch(e=>{throw e})}set_data(e){let t={action_name:"setdata",method:"POST",url:(0,s.A)().endpoint_url()+"online/setdata/?"+o.A.serialize_object(e)+o.A.add_token_as_parameter()},n=new a.A;return n.prepare_params(t).handle_response().catch(e=>{throw e})}}t.A=new r}}]);