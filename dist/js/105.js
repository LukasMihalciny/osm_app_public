"use strict";(self["webpackChunkosmapp_webpack_2xx"]=self["webpackChunkosmapp_webpack_2xx"]||[]).push([[105],{7654:function(e,t,s){var n=s(8700),o=s(6343),i=s(3175),a=s(5833),r=s(6460);class l{confirm_session(e){let t="";e&&(t=(0,r.A)().get_confirm_chbs(),t=o.A.serialize_object(t));let s={action_name:"confirm",method:"GET",url:(0,n.A)().endpoint_url()+"online/confirm/?"+t+o.A.add_token_as_parameter()},a=new i.A;return a.prepare_params(s).handle_response().then((e=>408===e.status||412===e.status?this.repeat_getsessioninfo(0):e)).catch((e=>{throw e}))}repeat_confirm(){let e={action_name:"confirm",method:"GET",url:(0,n.A)().endpoint_url()+"online/confirm/?"+o.A.add_token_as_parameter()},t=new i.A;return t.prepare_params(e).handle_response().catch((e=>{throw e}))}async repeat_getsessioninfo(e){e++;let t=10,s=10;console.log("wait "+s+" seconds then try getsessioninfo, iteration: "+e+" (max "+t+")"),await o.A.sleep(s);let r={action_name:"getsessioninfo",method:"GET",url:(0,n.A)().endpoint_url()+"online/getsessioninfo/?"+o.A.add_token_as_parameter()},l=new i.A;return l.prepare_params(r).handle_response().then((s=>{if(100===s.result?.state)return s;if(e>=t){let e=(new Date).toLocaleString(),t=(0,n.A)().get_session_token(),o=(0,n.A)().current_step();return(0,a.A)().set_last_request({},r,e,t,o,s),(0,n.A)().change_step(404),{status:408,action_name:"getsessioninfo"}}return this.repeat_getsessioninfo(e)})).catch((e=>{throw e}))}}t.A=new l},8494:function(e,t,s){var n=s(8700),o=s(6343),i=s(3175),a=s(6460);class r{offer_send(e="api"){let t=(0,a.A)().get_confirm_chbs();t=o.A.serialize_object(t);let s={action_name:"signature-offer-send",method:"GET",url:(0,n.A)().endpoint_url()+"online/signature-offer-send/?"+t+o.A.add_token_as_parameter()+"&name="+e},r=new i.A;return r.prepare_params(s).handle_response().catch((e=>{throw e}))}code_send(e){let t={action_name:"signature-code-send",method:"GET",url:(0,n.A)().endpoint_url()+"online/signature-code-send/?client="+e+o.A.add_token_as_parameter()},s=new i.A;return s.prepare_params(t).handle_response().catch((e=>{throw e}))}code_check(e,t){let s=(0,a.A)().get_confirm_chbs();s=o.A.serialize_object(s);let r={action_name:"signature-code-check",method:"POST",url:(0,n.A)().endpoint_url()+"online/signature-code-check/?"+s+"&client="+t+o.A.add_token_as_parameter(),body:JSON.stringify({code:e}),content_type:"application/json"},l=new i.A;return l.prepare_params(r).handle_response().catch((e=>{throw e}))}signature_status(){let e={action_name:"signature-status",method:"GET",url:(0,n.A)().endpoint_url()+"online/signature-status/?"+o.A.add_token_as_parameter()},t=new i.A;return t.prepare_params(e).handle_response().catch((e=>{throw e}))}}t.A=new r},821:function(e,t,s){s.d(t,{A:function(){return C}});var n=s(641);const o={key:0,class:"docs_download","data-cy":"documents"},i=(0,n.Lk)("h3",null," Predzmluvná dokumentácia ",-1),a=(0,n.Lk)("p",null," Dokumenty s ktorými je klient povinný sa oboznámiť ",-1),r={class:"docs_static"},l=(0,n.Lk)("p",null," Produktové dokumenty ",-1),c={class:"docs_session"},_=(0,n.Lk)("p",null," Dynamické dokumenty ",-1),u={key:1,class:"row docs_download","data-cy":"documents"},d={class:"col-12 col-md-6"},m={class:"s-box-body"},h=(0,n.Lk)("p",null," Dynamické dokumenty ",-1),p={class:"col-12 col-md-6"},k={class:"s-box-body"},g=(0,n.Lk)("p",null," Produktové dokumenty ",-1);function b(e,t,s,b,f,v){const A=(0,n.g2)("Document_download");return 4===s.step_html?((0,n.uX)(),(0,n.CE)("div",o,[i,a,(0,n.Lk)("div",r,[l,((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(f.static_docs,((e,t)=>((0,n.uX)(),(0,n.Wv)(A,{doc:e},null,8,["doc"])))),256))]),(0,n.Lk)("div",c,[_,((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(f.session_docs,((e,t)=>((0,n.uX)(),(0,n.Wv)(A,{doc:e},null,8,["doc"])))),256))])])):s.step_html>4?((0,n.uX)(),(0,n.CE)("div",u,[(0,n.Lk)("div",d,[(0,n.Lk)("div",m,[h,((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(f.session_docs,((e,t)=>((0,n.uX)(),(0,n.Wv)(A,{doc:e},null,8,["doc"])))),256))])]),(0,n.Lk)("div",p,[(0,n.Lk)("div",k,[g,((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(f.static_docs,((e,t)=>((0,n.uX)(),(0,n.Wv)(A,{doc:e},null,8,["doc"])))),256))])])])):(0,n.Q3)("",!0)}var f=s(4162),v=s(3886),A=s(3556),y=s(2873),w={props:{start_doc_requests:Boolean,step_html:Number},components:{Document_download:A.A},emits:["all_docs_finished"],data(){return{static_docs:{},session_docs:{},turbo:{repeat_count:0,repeat_delay_fast:2e3,repeat_delay_slow:1e4,repeat_diminish:10,repeat_max:26}}},created(){!0===this.start_doc_requests&&(this.group_docs(),this.session_docs_turbo())},methods:{group_docs(){f.A.static_documents().then((e=>{this.static_docs=e.result.documents}))},session_docs_turbo(){v.A.session_documents(!1).then((e=>{void 0!==e.result?.data?.documents&&(this.session_docs=e.result.data.documents);for(let s in this.session_docs)if(this.session_docs.hasOwnProperty(s)&&"ws-preview.tmp"===this.session_docs[s].name&&"error"===this.session_docs[s].documentState)return(0,y.A)().store_modal_data({type:"session_documents_webservice_doc_error",errors:this.session_docs[s].errors}),void(0,y.A)().open_it("Ordinary_error_modal");if(!0===e.result?.data?.processingFinished)return void this.$emit("all_docs_finished");if(this.turbo.repeat_count>this.turbo.repeat_max)return void console.log("getsessiondocuments reached maximum repeat_count");this.turbo.repeat_count++;let t=this.turbo.repeat_count<this.turbo.repeat_diminish?this.turbo.repeat_delay_fast:this.turbo.repeat_delay_slow;setTimeout((()=>{this.session_docs_turbo()}),t)}))}},computed:{},watch:{start_doc_requests(){!0===this.start_doc_requests&&(this.group_docs(),this.session_docs_turbo())}}},x=s(6262);const L=(0,x.A)(w,[["render",b]]);var C=L},9713:function(e,t,s){s.d(t,{A:function(){return d}});var n=s(641),o=s(33);const i={class:"calc_title_area"},a={class:"text-primary"},r={key:0,class:"mb-3"};function l(e,t,s,l,c,_){return(0,n.uX)(),(0,n.CE)("div",i,[(0,n.Lk)("h2",a,(0,o.v_)(s.title),1),s.subtitle?((0,n.uX)(),(0,n.CE)("p",r,(0,o.v_)(s.subtitle),1)):(0,n.Q3)("",!0),(0,n.RG)(e.$slots,"default")])}var c={props:{title:String,subtitle:String},components:{},emits:[],data(){return{}},created(){},methods:{},computed:{},watch:{}},_=s(6262);const u=(0,_.A)(c,[["render",l]]);var d=u},1391:function(e,t,s){s.d(t,{A:function(){return g}});var n=s(641),o=s(33),i=s(3751);const a={class:"row form-pagination"},r={class:"col-12 col-sm-6 text-center text-sm-start order-2 order-sm-1"},l={class:"col-12 col-sm-6 text-center text-sm-end order-1 order-sm-2"};function c(e,t,s,c,_,u){const d=(0,n.g2)("Bouncer_loading");return(0,n.uX)(),(0,n.CE)("div",a,[(0,n.Lk)("div",r,[s.allow_back?((0,n.uX)(),(0,n.CE)("button",{key:0,onClick:t[0]||(t[0]=(...e)=>u.edit_user_data&&u.edit_user_data(...e)),class:"btn btn-white btn-left btn-lg"}," Upraviť ")):(0,n.Q3)("",!0)]),(0,n.Lk)("div",l,[(0,n.bo)((0,n.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>u.main_button_press&&u.main_button_press(...e)),type:"button",class:"btn btn-accent btn-right btn-lg"},(0,o.v_)(u.wording),513),[[i.aG,!s.loading]]),(0,n.bo)((0,n.bF)(d,null,null,512),[[i.aG,s.loading]])])])}var _=s(55),u=s(8700),d=s(6460),m=s(9614),h={props:{mode:String,allow_back:Boolean,loading:Boolean},components:{Bouncer_loading:_.A},emits:["main_button_press"],data(){return{}},created(){},methods:{edit_user_data(){(0,d.A)().$reset(),(0,u.A)().change_step(3)},main_button_press(){this.$emit("main_button_press")}},computed:{wording(){let e={classic:"Dokončiť",agent:"Odoslať návrh emailom",client:"Vyžiadať SMS kód"};return e[this.mode]},requested_direction(){return(0,m.A)().get_requested_direction()}},watch:{requested_direction(){null!==this.requested_direction&&"backward"===this.requested_direction&&((0,m.A)().reset_requested_direction(),this.edit_user_data())}}},p=s(6262);const k=(0,p.A)(h,[["render",c]]);var g=k},4430:function(e,t,s){s.d(t,{A:function(){return L}});var n=s(641),o=s(33),i=s(3751);const a={class:"confirm_check"},r={class:"form-check"},l={for:"suhlas_elekt_kom",class:"form-check-label"},c={key:0,class:"form-check"},_={for:"suhlas_marketing",class:"form-check-label"},u={class:"confirm_check"},d={key:0,class:"mb-2"},m={class:"form-check"},h={for:"suhlas_navrh",class:"form-check-label"},p={class:"row"},k={class:"col-12"},g={class:"text-accent mt-2"};function b(e,t,s,b,f,v){return(0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.Lk)("div",a,[(0,n.Lk)("div",r,[(0,n.bo)((0,n.Lk)("input",{name:"suhlas_elekt_kom",id:"suhlas_elekt_kom","onUpdate:modelValue":t[0]||(t[0]=e=>v.suhlas_elekt_kom=e),"true-value":"1","false-value":"0",type:"checkbox",class:(0,o.C4)(["form-check-input",this.invalid_checkboxes?"required_checkbox":""])},null,2),[[i.lH,v.suhlas_elekt_kom]]),(0,n.Lk)("label",l,[(0,n.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>v.marketing_ek_modal&&v.marketing_ek_modal(...e)),class:"btn-text text-start"}," Súhlas s elektronickou komunikáciou ")])]),f.adult_marketing?((0,n.uX)(),(0,n.CE)("div",c,[(0,n.bo)((0,n.Lk)("input",{name:"suhlas_marketing",id:"suhlas_marketing","onUpdate:modelValue":t[2]||(t[2]=e=>v.suhlas_marketing=e),"true-value":"1","false-value":"0",type:"checkbox",class:"form-check-input"},null,512),[[i.lH,v.suhlas_marketing]]),(0,n.Lk)("label",_,[(0,n.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>v.marketing_modal&&v.marketing_modal(...e)),class:"btn-text text-start"}," Súhlas so spracovaním osobných údajov pre účely marketingu ")])])):(0,n.Q3)("",!0)]),(0,n.Lk)("div",u,[v.wording?.paragraph?((0,n.uX)(),(0,n.CE)("p",d,(0,o.v_)(v.wording?.paragraph),1)):(0,n.Q3)("",!0),(0,n.Lk)("div",m,[(0,n.bo)((0,n.Lk)("input",{name:"suhlas_navrh",id:"suhlas_navrh","onUpdate:modelValue":t[4]||(t[4]=e=>v.suhlas_navrh=e),"true-value":"1","false-value":"0",type:"checkbox",class:(0,o.C4)(["form-check-input",this.invalid_checkboxes?"required_checkbox":""])},null,2),[[i.lH,v.suhlas_navrh]]),(0,n.Lk)("label",h,(0,o.v_)(v.wording?.label),1)])]),(0,n.Lk)("div",p,[(0,n.Lk)("div",k,[(0,n.bo)((0,n.Lk)("p",g," Pred pokračovaním musíte potvrdiť zvýraznené zaškrtávacie políčka ",512),[[i.aG,s.invalid_checkboxes]])])])],64)}var f=s(2873),v=s(6460),A=s(3177),y={props:{mode:String,invalid_checkboxes:Boolean},components:{},emits:[],data(){return{adult_marketing:!0}},created(){let e=(0,A.A)().get_call_param("dss_osoba_dospely");this.adult_marketing="0"!==e},methods:{marketing_modal(){(0,f.A)().open_it("Marketing")},marketing_ek_modal(){(0,f.A)().open_it("Marketing_ek")}},computed:{suhlas_elekt_kom:{get(){return(0,v.A)().get_confirm_chbs().suhlas_elekt_kom},set(e){(0,v.A)().set_confirm_chb("suhlas_elekt_kom",e)}},suhlas_marketing:{get(){return(0,v.A)().get_confirm_chbs().suhlas_marketing},set(e){(0,v.A)().set_confirm_chb("suhlas_marketing",e)}},suhlas_navrh:{get(){return(0,v.A)().get_confirm_chbs().suhlas_navrh},set(e){(0,v.A)().set_confirm_chb("suhlas_navrh",e)}},wording(){let e={classic:{paragraph:"",label:"Uvedený návrh na uzatvorenie poistnej zmluvy som si prečítal(a) a súhlasím s ním. Týmto prehlasujem, že som bol oboznámený(á) s vyššie uvedenou predzmluvnou dokumentáciou, obsahu som porozumel(a) a týmto vyjadrujem súhlas."},agent:{paragraph:"Pre dokončenie zmluvy o poskytnutí finančnej služby je potrebné potvrdenie klienta formou SMS autorizácie.",label:"Totožnosť klienta som overil a súhlasím s odoslaním dokumentácie na email klienta, aby dokončil autorizáciu."},client:{paragraph:'Pre dokončenie zmluvy o poskytnutí finančnej služby je potrebné potvrdenie cez SMS kód - kliknutím na tlačitko "vyžiadať sms kód".',label:"Oboznámil som sa s predzmluvnou dokumentáciou, nemám žiadne výhrady s jej obsahom a žiadam o zaslanie SMS kódu na moje telefónne číslo."}};return e[this.mode]}},watch:{}},w=s(6262);const x=(0,w.A)(y,[["render",b]]);var L=x},2765:function(e,t,s){s.d(t,{A:function(){return W}});var n=s(641),o=s(33),i=s(3751);const a={class:"prop_confirm","data-cy":"signature_form"},r=(0,n.Lk)("h3",{class:"text-primary"}," Záverečné potvrdenie ",-1),l={key:2,class:"text-center"},c={class:"pt-2"},_={key:3,class:"text-center"},u={key:4,class:"text-center"},d={key:5,class:"text-center"},m=(0,n.Lk)("br",null,null,-1),h=(0,n.Lk)("br",null,null,-1),p={key:6,class:"row"},k={class:"col-12 col-md-6 mt-4"},g=(0,n.Lk)("br",null,null,-1),b={key:0,class:"text-primary"},f={key:1,class:"text-accent"},v={class:"mt-1 dots-primary"};function A(e,t,s,A,y,w){const x=(0,n.g2)("Confirm_checkboxes"),L=(0,n.g2)("Confirm_buttons"),C=(0,n.g2)("Bouncer_loading");return(0,n.bo)(((0,n.uX)(),(0,n.CE)("div",a,[r,w.is_step4&&null!==y.mode?((0,n.uX)(),(0,n.Wv)(x,{key:0,mode:y.mode,invalid_checkboxes:y.invalid_checkboxes},null,8,["mode","invalid_checkboxes"])):(0,n.Q3)("",!0),w.show_confirm?((0,n.uX)(),(0,n.Wv)(L,{key:1,mode:y.mode,allow_back:y.allow_back,loading:y.loading_offer,onMain_button_press:w.main_button_press},null,8,["mode","allow_back","loading","onMain_button_press"])):(0,n.Q3)("",!0),y.loading_confirm?((0,n.uX)(),(0,n.CE)("h5",l,[(0,n.eW)(" Potvrdzujeme... "),(0,n.Lk)("div",c,[(0,n.bF)(C)])])):(0,n.Q3)("",!0),!w.is_step4&&y.loading_offer?((0,n.uX)(),(0,n.CE)("h5",_," Aktivujeme finálne podpisovanie... ")):(0,n.Q3)("",!0),y.all_done?((0,n.uX)(),(0,n.CE)("h5",u," Všetky dokumenty boli podpísané. ")):(0,n.Q3)("",!0),y.missing_client?((0,n.uX)(),(0,n.CE)("h5",d,[(0,n.eW)(" Na klientov e-mail bola zaslaná predzmluvná dokumentácia."),m,(0,n.eW)(" Pre dokončenie, je potrebné, aby klient otvoril zaslaný odkaz."),h,(0,n.eW)(" Až potom bude môcť podpísať dokumenty. ")])):(0,n.Q3)("",!0),w.show_clients?((0,n.uX)(),(0,n.CE)("div",p,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(y.clients,((e,t)=>((0,n.uX)(),(0,n.CE)("div",k,[(0,n.Lk)("strong",null,(0,o.v_)(e.name),1),(0,n.eW)(),(0,n.Lk)("em",null,(0,o.v_)(e.role),1),(0,n.eW)(),(0,n.Lk)("em",null,(0,o.v_)(t===y.logged_client?"(práve prihlásený)":""),1),(0,n.eW)(),g,e.signed_client?((0,n.uX)(),(0,n.CE)("span",b," podpísaný ")):((0,n.uX)(),(0,n.CE)("span",f," nepodpísaný ")),(0,n.Lk)("ul",v,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.documents,((e,t)=>((0,n.uX)(),(0,n.CE)("li",null,(0,o.v_)(e.name),1)))),256))])])))),256))])):(0,n.Q3)("",!0)],512)),[[i.aG,w.show_signature_section]])}s(4979),s(1678);var y=s(4430),w=s(1391),x=s(8494),L=s(8700),C=s(2873),E=s(6460),X=s(7654),z=s(55),j={props:{},components:{Confirm_checkboxes:y.A,Confirm_buttons:w.A,Bouncer_loading:z.A},emits:[],data(){return{sign_status:{},next_name:null,sign_type:null,mode:null,clients:[],logged_client:"",loading_offer:!1,loading_confirm:!1,missing_client:!1,invalid_checkboxes:!1,allow_back:!1,all_done:!1}},created(){this.run_status_api()},methods:{main_button_press(){"agent"===this.mode?this.run_offer_api():"client"===this.mode&&(1===this.sign_type?this.open_sms():3===this.sign_type?this.open_signi():console.log("unknown sign type",this.sign_type))},run_status_api(){x.A.signature_status().then((e=>{if(this.sign_status=e.result,this.next_name=null,this.clients=null,null===this.sign_status.current){let t=e.result.status;for(let e in t)"pending"===t[e].state&&(this.is_step4&&("preconfirm"===t[e].when||null===t[e].when)||!this.is_step4&&"confirm"===t[e].when)&&(this.next_name=e);null===this.next_name?this.is_step4?(console.log("signature auto confirm"),this.mode=null,this.run_sign_confirm()):(this.all_done=!0,console.log("no signature for step5")):(this.is_step4&&(this.allow_back=!0),this.mode="agent",console.log("next_name",structuredClone(this.next_name)),this.is_step4||this.run_offer_api())}else{let t=e.result.current;if(this.sign_type=e.result.status[t].type,-1===[1,3].indexOf(this.sign_type))return void console.log("unrecognized sign type: "+this.sign_type);this.clients=e.result.status[t].signature_status.clients,this.logged_client="";let s=(0,L.A)().get_signature_role();for(let e in this.clients)if(s===this.clients[e].role){this.logged_client=e;break}""===this.logged_client?(console.log("didnt found client with role: ",s),this.missing_client=!0,this.mode=null):this.mode="client",console.dir("clients",structuredClone(this.clients),"logged:",s,this.logged_client)}}))},run_offer_api(){this.invalid_checkboxes=(0,E.A)().are_checkboxes_invalid(),this.invalid_checkboxes&&this.is_step4||(this.loading_offer=!0,x.A.offer_send(this.next_name).then((e=>{this.loading_offer=!1,200===e.status&&(console.dir("offer send success",e.result),this.allow_back=!1,this.run_status_api(),this.is_step4&&(0,C.A)().open_it("Signature_agent"))})))},open_sms(){this.invalid_checkboxes=(0,E.A)().are_checkboxes_invalid(),this.invalid_checkboxes&&this.is_step4||((0,C.A)().store_modal_data({client_uuid:this.logged_client}),(0,C.A)().open_it("Signature_client"))},open_signi(){if(this.invalid_checkboxes=(0,E.A)().are_checkboxes_invalid(),!this.invalid_checkboxes||!this.is_step4)for(let e in this.clients[this.logged_client].documents){let t=this.clients[this.logged_client].documents[e];window.open(t.contractLink,"_blank").focus()}},run_sign_confirm(){this.loading_confirm=!0,X.A.confirm_session(!1).then((e=>{this.loading_confirm=!1,200!==e.status||"success"!==e.result?.response&&100!==e.result?.state?((0,C.A)().store_modal_data({type:"confirm_step4_didnt_succeed",errors:e.result?.data?.errors||{message:e.result?.message}}),(0,C.A)().open_it("Ordinary_error_modal")):(0,L.A)().change_step(5)}))}},computed:{is_step4(){return 4===(0,L.A)().current_step()},show_signature_section(){return this.is_step4||!this.is_step4&&!this.all_done},show_clients(){return!this.is_step4},show_confirm(){return null!==this.mode&&!0!==this.clients?.[this.logged_client]?.signed_client},code_modal_closing(){return(0,C.A)().get_modal_event_data()}},watch:{code_modal_closing(){null!==this.code_modal_closing&&(this.run_status_api(),(0,C.A)().del_modal_event_data())}}},S=s(6262);const q=(0,S.A)(j,[["render",A]]);var W=q}}]);