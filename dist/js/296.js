"use strict";(self["webpackChunkosmapp_webpack_3xx"]=self["webpackChunkosmapp_webpack_3xx"]||[]).push([[296],{6884:function(e,a,t){var i=t(8700),o=t(6343),n=t(3175);class s{identity_scan(e,a){let t={action_name:"identity-scan",method:"GET",url:(0,i.A)().endpoint_url()+"online/identity-scan/?"+o.A.add_token_as_parameter()};t.url+="&serviceToken=veriface&scanGroupName="+e+"&identType="+a;let s=new n.A;return s.prepare_params(t).handle_response().catch((e=>{throw e}))}identity_check(e){let a={action_name:"identity-scan-check",method:"GET",url:(0,i.A)().endpoint_url()+"online/identity-scan-check/?"+o.A.add_token_as_parameter()};a.url+="&serviceToken=veriface&scanGroupName="+e;let t=new n.A;return t.prepare_params(a).handle_response().catch((e=>{throw e}))}identity_refresh(){let e={action_name:"id-scan/get-scan-groups",method:"GET",url:(0,i.A)().endpoint_url()+"api/online/id-scan/get-scan-groups/?"+o.A.add_token_as_parameter()},a=new n.A;return a.prepare_params(e).handle_response().catch((e=>{throw e}))}identity_flow_scan(e,a,t){let o={action_name:"identity-scan",method:"GET",url:(0,i.A)().endpoint_url()+"osmapi/identity-scan/"+(0,i.A)().get_session_token()+"/?"};o.url+="serviceToken=veriface&identToken="+e+"&identType="+a+"&action-id="+t;let s=new n.A;return s.prepare_params(o).handle_response().catch((e=>{throw e}))}identity_flow_check(e,a){let t={action_name:"identity-scan-check",method:"GET",url:(0,i.A)().endpoint_url()+"osmapi/identity-scan-check/"+(0,i.A)().get_session_token()+"/?"};t.url+="serviceToken=veriface&identToken="+e+"&action-id="+a;let o=new n.A;return o.prepare_params(t).handle_response().catch((e=>{throw e}))}identity_flow_refresh(){let e={action_name:"identity-scan-check",method:"GET",url:(0,i.A)().endpoint_url()+"osmapi/identity-scan-check/"+(0,i.A)().get_session_token()+"/?"};e.url+="serviceToken=veriface";let a=new n.A;return a.prepare_params(e).handle_response().catch((e=>{throw e}))}}a.A=new s},8296:function(e,a,t){t.r(a),t.d(a,{default:function(){return M}});var i=t(641),o=t(33);const n={class:"row facial_scan"},s={key:0,class:"col-12 mb-5 mt-2"},r={class:"lead"},c={key:1,class:"col-12 col-sm-6 mb-5"},d={class:"fw-bold"},l={key:1},_={class:"fw-bold"},u=["href"],v={key:1},k={class:"fw-bold"},p={key:1},f={key:2,class:"col-12 col-sm-6 mb-5 d-none d-sm-block"},h=["src"],m={key:1,class:"qr_code placeholder"},b={key:3,class:"col-12"},y={class:"text-center"},E=["disabled"],g={key:4,class:"col-12"},A={key:5,class:"col-12 text-center mt-3",style:{"min-height":"19px"}},N={class:"col-12 mb-3"};function C(e,a,t,C,O,w){const L=(0,i.g2)("Veriface_iframe"),D=(0,i.g2)("Bouncer_loading"),T=(0,i.g2)("Scan_feedback"),S=(0,i.g2)("Modal_body");return(0,i.uX)(),(0,i.Wv)(S,{close:!O.load_iframe,title:"op"===w.scan_type?"Naskenovanie dokladov":"Tvárová biometria",class:(0,o.C4)("op"===w.scan_type?"modal-credentials_scan":"modal-faceauth"),modal_size:O.load_iframe?"medium":""},{default:(0,i.k6)((()=>[(0,i.Lk)("div",n,[O.load_iframe?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("div",s,[(0,i.Lk)("p",r,[(0,i.eW)((0,o.v_)("op"===w.scan_type?"Pre bezpečné overenie Vašej osoby nahrajte prosím doklad totožnosti.":"Pre bezpečné overenie Vašej osoby potrebujeme porovnať doklad totožnosti s tvárovou biometriou.")+" ",1),a[4]||(a[4]=(0,i.Lk)("br",null,null,-1)),a[5]||(a[5]=(0,i.eW)("Vyberte si jednu z možností, podľa preferovaného zariadenia: "))])])),O.already_done||O.load_iframe?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("div",c,[a[6]||(a[6]=(0,i.Lk)("p",null,[(0,i.Lk)("b",{class:"text-primary"},"A) "),(0,i.eW)("Pre spustenie overovania na "),(0,i.Lk)("b",null,"tomto zariadení"),(0,i.eW)(" kliknite na link.")],-1)),(0,i.Lk)("p",d,[O.veriface_link?((0,i.uX)(),(0,i.CE)("a",{key:0,onClick:a[0]||(a[0]=(...e)=>w.open_veriface_next_tab&&w.open_veriface_next_tab(...e)),href:"#"},(0,o.v_)(O.veriface_link),1)):((0,i.uX)(),(0,i.CE)("span",l,"Načítavam..."))]),a[7]||(a[7]=(0,i.Lk)("p",{class:"mt-4"},[(0,i.Lk)("b",{class:"text-primary"},"B) "),(0,i.eW)("Pre preposlanie emailom na "),(0,i.Lk)("b",null,"iné zariadenie"),(0,i.eW)(", kliknite na link.")],-1)),(0,i.Lk)("p",_,[O.veriface_link?((0,i.uX)(),(0,i.CE)("a",{key:0,href:w.mail_sample}," Skopírovať do emailového klienta. ",8,u)):((0,i.uX)(),(0,i.CE)("span",v,"Načítavam..."))]),a[8]||(a[8]=(0,i.Lk)("p",{class:"mt-4"},[(0,i.Lk)("b",{class:"text-primary"},"C) "),(0,i.eW)("Pre spustenie overovania v "),(0,i.Lk)("b",null,"tomto okne"),(0,i.eW)(" kliknite na link.")],-1)),(0,i.Lk)("p",k,[O.veriface_link?((0,i.uX)(),(0,i.CE)("a",{key:0,onClick:a[1]||(a[1]=(...e)=>w.switch_to_iframe&&w.switch_to_iframe(...e)),href:"#"}," VeriFace iframe (odporúčané) ")):((0,i.uX)(),(0,i.CE)("span",p,"Načítavam..."))])])),O.already_done||O.load_iframe?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("div",f,[a[9]||(a[9]=(0,i.Lk)("p",null,[(0,i.Lk)("b",{class:"text-primary"},"D) "),(0,i.eW)("Pre spustenie overovania na "),(0,i.Lk)("b",null,"mobilnom zariadení"),(0,i.eW)(", načítajte QR kód.")],-1)),O.veriface_qr?((0,i.uX)(),(0,i.CE)("img",{key:0,src:O.veriface_qr,class:"qr_code"},null,8,h)):((0,i.uX)(),(0,i.CE)("div",m))])),O.already_done||O.load_iframe?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("div",b,[a[10]||(a[10]=(0,i.Lk)("ul",{class:"mb-4 dots-primary"},[(0,i.Lk)("li",{class:"mb-0"},"Okno nezatvárajte."),(0,i.Lk)("li",{class:"mb-0"},"Pripravte si doklad totožnosti."),(0,i.Lk)("li",{class:"mb-0"},"Otvorte aplikáciu overovania na Vami preferovanom zariadení."),(0,i.Lk)("li",{class:"mb-0"},"Postupujte podľa pokynov v aplikácii overovania."),(0,i.Lk)("li",{class:"mb-0"},'Keď proces úspešne dokončíte kliknite na tlačidlo "Skontrolovať stav".')],-1)),(0,i.Lk)("div",y,[(0,i.Lk)("button",{onClick:a[2]||(a[2]=(...e)=>w.face_check&&w.face_check(...e)),disabled:O.loading,class:"btn btn-primary"}," Skontrolovať stav ",8,E),O.manual_close_button?((0,i.uX)(),(0,i.CE)("button",{key:0,onClick:a[3]||(a[3]=(...e)=>w.close_the_face&&w.close_the_face(...e)),class:"btn btn-primary ms-1"}," Validate ")):(0,i.Q3)("",!0)])])),!O.already_done&&O.load_iframe?((0,i.uX)(),(0,i.CE)("div",g,[(0,i.bF)(L,{veriface_link:O.veriface_link,onVeriface_closing:w.veriface_closing},null,8,["veriface_link","onVeriface_closing"])])):(0,i.Q3)("",!0),O.already_done?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("div",A,[O.loading?((0,i.uX)(),(0,i.Wv)(D,{key:0})):(0,i.Q3)("",!0)])),(0,i.Lk)("div",N,[(0,i.bF)(T,{feedback:O.feedback},null,8,["feedback"])])])])),_:1},8,["close","title","class","modal_size"])}t(4114);var O=t(4883),w=t(2873),L=t(55),D=t(6884),T=t(6460),S=t(3177),I=t(9614),j=t(7406),z=t(8700),R=t(5143);const V=["src"];function X(e,a,t,n,s,r){return(0,i.uX)(),(0,i.CE)("iframe",{src:t.veriface_link+"&embedded=true",allow:"camera;microphone",scrolling:"no",style:(0,o.Tr)([{width:"100%",transition:"all .5s","min-height":"300px",overflow:"none"},{height:s.height+"px"}])},null,12,V)}var U={props:{veriface_link:String},components:{},emits:["veriface_closing"],data(){return{height:300}},created(){window.addEventListener("message",this.listen_to_veriface)},beforeUnmount(){window.removeEventListener("message",this.listen_to_veriface)},methods:{listen_to_veriface(e){"https://app.veriface.eu"===e.origin&&("height"===e.data.action?this.height=Math.round(e.data.value):"close"===e.data.action&&this.$emit("veriface_closing",e.data.result))}},computed:{},watch:{}},W=t(6262);const x=(0,W.A)(U,[["render",X]]);var P=x,F={props:{},components:{Modal_body:O.A,Bouncer_loading:L.A,Scan_feedback:j.A,Veriface_iframe:P},emits:[],data(){return{debug:!0,loading:!0,already_done:!1,veriface_link:"",veriface_qr:"",success_object:{},feedback:[],manual_close_button:!1,load_iframe:!1}},created(){this.debug&&(this.add_feedback("DEBUG ON."),this.add_feedback("scanGroupName: "+this.facial_input_token)),this.face_init()},methods:{face_init(){if("1"===(0,S.A)().get_form_value(this.facial_input_token))return this.add_feedback("Skenovanie dokumentov je úspešne ukončené."),void(this.already_done=!0);this.loading=!0,this.common_api?D.A.identity_scan(this.facial_input_token,this.scan_type).then((e=>{if(this.loading=!1,200!==e.status)return this.add_feedback("Aktivácia overovania zlyhala."),void this.add_feedback(JSON.stringify(e.result?.message));this.veriface_link=e.result?.data?.url,this.veriface_qr=e.result?.data?.base64png?"data:image/png;base64,"+e.result?.data?.base64png:""})):D.A.identity_flow_scan(this.facial_input_token,this.scan_type,this.flow_action_id).then((e=>{if(this.loading=!1,200!==e.status)return this.add_feedback("Aktivácia overovania zlyhala."),void this.add_feedback(JSON.stringify(e.result?.message));this.veriface_link=e.result?.data?.resultData?.data?.url,this.veriface_qr=e.result?.data?.resultData?.data?.base64png?"data:image/png;base64,"+e.result?.data?.resultData?.data?.base64png:""}))},face_check(){this.loading=!0,this.common_api?D.A.identity_check(this.facial_input_token).then((e=>{if(this.loading=!1,200!==e.status)return this.add_feedback("Kontrola overovania zlyhala."),void this.add_feedback(JSON.stringify(e.result?.message));let a=e.result;this.face_fill(a)})):D.A.identity_flow_check(this.facial_input_token,this.flow_action_id).then((e=>{if(this.loading=!1,200!==e.status)return this.add_feedback("Kontrola overovania zlyhala."),void this.add_feedback(JSON.stringify(e.result?.message));let a=e.result?.data?.resultData;this.face_fill(a)}))},face_fill(e){let a={NEW:"Novo vytvorené overenie, overovací proces ešte nebol spustený",WAITING_ENDUSER:"Overovací proces bol spustený a čaká sa na dokončenie",VERIFIED:"Výsledok overovacieho procesu je “Overený”",REFUSED:"Výsledok overovacieho procesu je “Zamietnutý”",VERIFIED_WARNING:"Overený s upozornením",PARTIALLY_VERIFIED:"Čiastočne overený",CANCELLED:"Overovací proces bol zrušený overovanou osobu",VALIDATION_NEEDED:"Výsledok overovacieho procesu nie je jednoznačný a je ho nutné ručne potvrdiť",VERIFIED_MANUAL:"Ručne potvrdený výsledok so stavom “Overený”",REFUSED_MANUAL:"Ručne potvrdený výsledok so stavom “Zamietnutý”",ACTION_NEEDED:"Je nutný zásah oprávnenej osoby (napr. pri zlej detekcií údajov, po manuálnej oprave oprávnenej osoby)",ERROR:"Chyba počas overovacieho procesu",WAITING:"Čaká sa na výsledné vyhodnotenie systémom",UNKNOWN:"Neznámy výsledok",EXPIRED:"Overovací proces exspiroval, tj. overovaná osoba ho neotvorila včas, alebo nedokončila v stanovenom čase"},t={UNSTARTED:"Overovací proces ešte nebol spustený",NOT_FINISHED:"Overovací proces nebol dokončený",SUCCESS:"Overovací proces bol úspešne ukončený",FAILURE:"Overovací proces bol neúspešný",CANCELLED:"Overovací proces bol odmietnutý overovanou osobou",EXPIRED:"Overovací proces nebol dokončený včas",POSTPONED:"Overovací proces bol dočasne prerušený overovanou osobou"},i=e?.["provider-info"]?.status,o=e?.["provider-info"]?.verificationEndUserStatus,n=e?.["scan-status"],s=e?.data;if(this.debug&&this.add_feedback("veriface status: "+i),this.add_feedback(a[i]),this.debug&&this.add_feedback("end user status: "+o),this.add_feedback(t[o]),"NEW"===i&&"UNSTARTED"===o?(this.debug&&this.add_feedback("COMBO:"),this.add_feedback("Otvorte overovaciu aplikáciu na ľubovolnom zariadení")):"WAITING_ENDUSER"!==i||"UNSTARTED"!==o&&"POSTPONED"!==o&&"NOT_FINISHED"!==o?"CANCELLED"===i&&"CANCELLED"===o?(this.debug&&this.add_feedback("COMBO:"),this.add_feedback("Zatvorte okno a zopakujte akciu znovu")):"WAITING"===i&&"SUCCESS"===o?(this.debug&&this.add_feedback("COMBO:"),this.add_feedback("Overovanie prebieha, zopakujte za chvíľu prosím")):"VERIFIED"===i&&"SUCCESS"===o&&(this.debug&&this.add_feedback("COMBO:"),this.add_feedback("Overovanie úspešne dokončené")):(this.debug&&this.add_feedback("COMBO:"),this.add_feedback("Pokračujte prosím v overovacej aplikácii")),"verified"!==n)return;if("object"!==typeof s||Object.keys(s).length<=0)return this.add_feedback("Dáta v nesprávnom formáte."),void this.add_feedback(JSON.stringify(e));this.add_feedback("Overovanie bolo úspešné. Ukladáme Vaše údaje."),this.success_object=s,(0,S.A)().set_form_value(this.facial_input_token,"1"),(0,T.A)().clear_one_error(this.facial_input_token);let r=this.facial_settings?.prefix||"",c=this.facial_settings?.suffix||"";if((0,S.A)().set_multiple_form_values(this.success_object,r,c),this.debug)return this.add_feedback(JSON.stringify(this.success_object)),this.add_feedback('PREFIX: "'+r+'"'),this.add_feedback('SUFFIX: "'+c+'"'),this.add_feedback('auto close is disabled, click on "VALIDATE"'),void(this.manual_close_button=!0);setTimeout((()=>{this.close_the_face()}),3e3)},close_the_face(){(0,w.A)().close_them_all(),(0,I.A)().set_requested_direction("forward")},open_veriface_next_tab(e){e.preventDefault(),window.open(this.veriface_link,"_blank").focus()},add_feedback(e){this.feedback.push(e)},switch_to_iframe(e){e.preventDefault(),this.load_iframe=!0},veriface_closing(e){this.add_feedback(e),this.load_iframe=!1,this.face_check()}},computed:{facial_input_token(){return(0,w.A)().retrieve_modal_data().field_id},facial_settings(){return(0,w.A)().retrieve_modal_data().data_fill},scan_type(){return(0,w.A)().retrieve_modal_data().scan_type},flow_action_id(){if(this.common_api)return null;let e=(0,R.A)().get_workflow_actions();for(let a in e)if("identityScan"===e[a]?.function&&e[a]?.functionParams?.identToken===this.facial_input_token)return e[a].id;return null},common_api(){return"form_app"===(0,z.A)().get_run_mode()},mail_sample(){let e=encodeURIComponent("op"===this.scan_type?"Naskenovanie dokladov":"Tvárová biometria"),a=encodeURIComponent("Dobrý deň, \n\r zasielame Vám link pre overenie totožnosti: \n\r\n\r "+this.veriface_link+" \n\r\n\r S pozdravom \n\r");return"mailto:?subject="+e+"&body="+a}},watch:{}};const G=(0,W.A)(F,[["render",C]]);var M=G}}]);