"use strict";(self["webpackChunkosmapp_webpack_3xx"]=self["webpackChunkosmapp_webpack_3xx"]||[]).push([[363,977],{4162:function(t,e,s){var n=s(8700),o=s(6343),a=s(3175),r=s(3177);class i{static_documents(){let t={action_name:"getdocuments",method:"GET",url:(0,n.A)().endpoint_url()+"online/getdocuments/"+(0,r.A)().get_selected_product().product_id+"/?"+o.A.add_token_as_parameter()},e=new a.A;return e.prepare_params(t).handle_response().catch((t=>{throw t}))}get_static_document(t){let e={action_name:"getdocument",method:"GET",url:(0,n.A)().endpoint_url()+"online/getdocument/"+(0,r.A)().get_selected_product().product_id+"/"+t+"/?"+o.A.add_token_as_parameter()+"&nocontent=true"},s=new a.A;return s.prepare_params(e).handle_response().catch((t=>{throw t}))}}e.A=new i},7004:function(t,e,s){var n=s(8700),o=s(6343),a=s(3175);class r{payment_info(){let t={action_name:"getpaymentinfo",method:"GET",url:(0,n.A)().endpoint_url()+"online/getpaymentinfo/?"+o.A.add_token_as_parameter()},e=new a.A;return e.prepare_params(t).handle_response().catch((t=>{throw t}))}generate_qr(){let t={action_name:"getpaymentqr",method:"GET",url:(0,n.A)().endpoint_url()+"online/getpaymentqr/?"+o.A.add_token_as_parameter()},e=new a.A;return e.prepare_params(t).handle_response().catch((t=>{throw t}))}get_gateways(){let t={action_name:"getpaymentgateways",method:"GET",url:(0,n.A)().endpoint_url()+"online/getpaymentgateways/?"+o.A.add_token_as_parameter()},e=new a.A;return e.prepare_params(t).handle_response().catch((t=>{throw t}))}payment_create(t){let e={action_name:"payment-create",method:"POST",url:(0,n.A)().endpoint_url()+"online/payment-create/"+t+"/?"+o.A.add_token_as_parameter()},s=new a.A;return s.prepare_params(e).handle_response().catch((t=>{throw t}))}payment_result(t,e){let s={action_name:"payment-result",method:"PUT",url:(0,n.A)().endpoint_url()+"online/payment-result/"+t+"/?result="+e+o.A.add_token_as_parameter()},r=new a.A;return r.prepare_params(s).handle_response().catch((t=>{throw t}))}}e.A=new r},4688:function(t,e,s){s.d(e,{A:function(){return k}});var n=s(641),o=s(33),a=s(3751);const r={class:"w-100 btn-text text-start"};function i(t,e,s,i,l,c){const d=(0,n.g2)("Bouncer_loading");return c.display_document?((0,n.uX)(),(0,n.CE)("button",{key:0,"data-cy":"document_download",onClick:e[0]||(e[0]=(...t)=>c.download_pdf&&c.download_pdf(...t)),class:(0,o.C4)(["d-flex btn-text i_anchor",c.still_waiting?"document_waiting":""])},[(0,n.Lk)("div",r,[(0,n.eW)((0,o.v_)(c.name)+" ",1),(0,n.bo)((0,n.bF)(d,{size:"small"},null,512),[[a.aG,c.still_waiting]])]),e[1]||(e[1]=(0,n.Lk)("div",{class:"flex-shrink my-auto"},[(0,n.Lk)("span",{class:"i_download_item"})],-1))],2)):(0,n.Q3)("",!0)}var l=s(4162),c=s(3886),d=s(55),u=s(6343),_=s(8700),m=s(3177),p={props:{doc:Object},components:{Bouncer_loading:d.A},data(){return{is_downloading:!1}},created(){},methods:{download_pdf(){this.still_waiting||(this.is_downloading=!0,this.is_static?l.A.get_static_document(this.doc.id).then((t=>{if(200===t.status){if(void 0!==t.result.download_token&&null!==t.result.download_token){let e=(0,_.A)().document_url()+"?access_token="+t.result.download_token;window.open(e)}else u.A.downloadBase64(this.name,t.result.content);this.is_downloading=!1}else this.is_downloading=!1})):c.A.get_session_document(this.doc.id).then((t=>{200===t.status?(u.A.downloadBase64(this.name,t.result.content),this.is_downloading=!1):this.is_downloading=!1})))}},computed:{is_static(){return void 0!==this.doc.filename},name(){return this.is_static?this.doc.filename:this.doc.name},display_document(){if("ws-preview.tmp"===this.name||"error"===this.doc.documentState)return!1;let t=(0,m.A)().get_selected_product().product_id+"";return!(this.doc.tags.includes("limity")&&!this.doc.tags.includes(t))},still_waiting(){return!!this.is_downloading||!this.is_static&&("waiting"===this.doc.documentState||"available"!==this.doc.documentState)}}},h=s(6262);const g=(0,h.A)(p,[["render",i],["__scopeId","data-v-5485f504"]]);var k=g},4001:function(t,e,s){s.d(e,{A:function(){return w}});var n=s(641);const o={key:0,class:"docs_download","data-cy":"documents"},a={class:"docs_static"},r={class:"docs_session"},i={key:1,class:"row docs_download","data-cy":"documents"},l={class:"col-12 col-md-6"},c={class:"s-box-body"},d={class:"col-12 col-md-6"},u={class:"s-box-body"};function _(t,e,s,_,m,p){const h=(0,n.g2)("Document_download");return 4===s.step_html?((0,n.uX)(),(0,n.CE)("div",o,[e[2]||(e[2]=(0,n.Lk)("h3",null," Predzmluvná dokumentácia ",-1)),e[3]||(e[3]=(0,n.Lk)("p",null," Dokumenty s ktorými je klient povinný sa oboznámiť ",-1)),(0,n.Lk)("div",a,[e[0]||(e[0]=(0,n.Lk)("p",null," Produktové dokumenty ",-1)),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(m.static_docs,((t,e)=>((0,n.uX)(),(0,n.Wv)(h,{doc:t},null,8,["doc"])))),256))]),(0,n.Lk)("div",r,[e[1]||(e[1]=(0,n.Lk)("p",null," Dynamické dokumenty ",-1)),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(m.session_docs,((t,e)=>((0,n.uX)(),(0,n.Wv)(h,{doc:t},null,8,["doc"])))),256))])])):s.step_html>4?((0,n.uX)(),(0,n.CE)("div",i,[(0,n.Lk)("div",l,[(0,n.Lk)("div",c,[e[4]||(e[4]=(0,n.Lk)("p",null," Dynamické dokumenty ",-1)),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(m.session_docs,((t,e)=>((0,n.uX)(),(0,n.Wv)(h,{doc:t},null,8,["doc"])))),256))])]),(0,n.Lk)("div",d,[(0,n.Lk)("div",u,[e[5]||(e[5]=(0,n.Lk)("p",null," Produktové dokumenty ",-1)),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(m.static_docs,((t,e)=>((0,n.uX)(),(0,n.Wv)(h,{doc:t},null,8,["doc"])))),256))])])])):(0,n.Q3)("",!0)}var m=s(4162),p=s(3886),h=s(4688),g=s(2873),k={props:{start_doc_requests:Boolean,step_html:Number},components:{Document_download:h.A},emits:["all_docs_finished"],data(){return{static_docs:{},session_docs:{},turbo:{repeat_count:0,repeat_delay_fast:2e3,repeat_delay_slow:1e4,repeat_diminish:10,repeat_max:26}}},created(){!0===this.start_doc_requests&&(this.group_docs(),this.session_docs_turbo())},methods:{group_docs(){m.A.static_documents().then((t=>{this.static_docs=t.result.documents}))},session_docs_turbo(){p.A.session_documents(!1).then((t=>{void 0!==t.result?.data?.documents&&(this.session_docs=t.result.data.documents);for(let s in this.session_docs)if(this.session_docs.hasOwnProperty(s)&&"ws-preview.tmp"===this.session_docs[s].name&&"error"===this.session_docs[s].documentState)return(0,g.A)().store_modal_data({type:"session_documents_webservice_doc_error",errors:this.session_docs[s].errors,is_client_role:!1}),void(0,g.A)().open_it("Ordinary_error_modal");if(!0===t.result?.data?.processingFinished)return void this.$emit("all_docs_finished");if(this.turbo.repeat_count>this.turbo.repeat_max)return void console.log("getsessiondocuments reached maximum repeat_count");this.turbo.repeat_count++;let e=this.turbo.repeat_count<this.turbo.repeat_diminish?this.turbo.repeat_delay_fast:this.turbo.repeat_delay_slow;setTimeout((()=>{this.session_docs_turbo()}),e)}))}},computed:{},watch:{start_doc_requests(){!0===this.start_doc_requests&&(this.group_docs(),this.session_docs_turbo())}}},y=s(6262);const v=(0,y.A)(k,[["render",_]]);var w=v},1050:function(t,e,s){s.d(e,{A:function(){return p}});var n=s(641),o=s(3751);const a={class:"gateways","data-cy":"gateways"},r=["href","id","title"],i=["src","alt"];function l(t,e,s,l,c,d){return(0,n.uX)(),(0,n.CE)(n.FK,null,[e[0]||(e[0]=(0,n.Lk)("h4",null,"Platba online",-1)),(0,n.Lk)("div",a,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(c.gateways,((t,e)=>(0,n.bo)(((0,n.uX)(),(0,n.CE)("a",{href:t.url,id:e,title:t.name,target:"_blank"},[(0,n.Lk)("img",{src:t.logo,alt:t.name,width:"127"},null,8,i)],8,r)),[[o.aG,""!==t.url]]))),256))])],64)}var c=s(7004),d=s(8700),u={props:{},components:{},emits:[],data(){return{gateways:{}}},created(){c.A.get_gateways().then((t=>{for(let e in t.result){if(!t.result.hasOwnProperty(e))continue;if(isNaN(e))continue;let s=t.result[e]?.name,n=t.result[e]?.url_logo;null===n?n="":"http"!==n.substring(0,4)&&(n="https://www.najpoistenie.sk/wp-content/themes/najpoistenie/images/loga-banky/"+n+".png"),this.gateways[e]={logo:n,name:s,url:""},c.A.payment_create(e).then((t=>{200!==t.status&&console.log("requesting gateway URL failed with id: "+e,t),this.gateways[e].url=t.result.url;let s=(0,d.A)().get_payment_data().payment_debug;s&&this.debug_url_for_payment_gateway(e)}))}}))},methods:{debug_url_for_payment_gateway(t){let e=this.gateways[t].url,s=e?.replace("pay-request","pay-request-test");this.gateways[t].url=s}},computed:{},watch:{}},_=s(6262);const m=(0,_.A)(u,[["render",l]]);var p=m},5116:function(t,e,s){s.d(e,{A:function(){return d}});var n=s(641),o=s(33);function a(t,e,s,a,r,i){return(0,n.uX)(),(0,n.CE)(n.FK,null,[e[0]||(e[0]=(0,n.Lk)("h4",null,"Platba prevodom na účet",-1)),e[1]||(e[1]=(0,n.eW)(" IBAN: ")),(0,n.Lk)("strong",null,(0,o.v_)(r.payment_info.iban),1),e[2]||(e[2]=(0,n.Lk)("br",null,null,-1)),e[3]||(e[3]=(0,n.eW)(" SWIFT: ")),(0,n.Lk)("strong",null,(0,o.v_)(r.payment_info.swift),1),e[4]||(e[4]=(0,n.Lk)("br",null,null,-1)),e[5]||(e[5]=(0,n.eW)(" Platba: ")),(0,n.Lk)("strong",null,(0,o.v_)(r.payment_info.amount),1),e[6]||(e[6]=(0,n.Lk)("br",null,null,-1)),e[7]||(e[7]=(0,n.eW)(" Variabilný symbol: ")),(0,n.Lk)("strong",null,(0,o.v_)(r.payment_info.vs),1),e[8]||(e[8]=(0,n.Lk)("br",null,null,-1)),e[9]||(e[9]=(0,n.eW)(" Konštantný symbol: ")),(0,n.Lk)("strong",null,(0,o.v_)(r.payment_info.ks),1),e[10]||(e[10]=(0,n.Lk)("br",null,null,-1))],64)}var r=s(7004),i={props:{},components:{},emits:[],data(){return{payment_info:{}}},created(){r.A.payment_info().then((t=>{200===t.status&&(this.payment_info=t.result.paymentinfo)}))},methods:{},computed:{},watch:{}},l=s(6262);const c=(0,l.A)(i,[["render",a]]);var d=c},132:function(t,e,s){s.d(e,{A:function(){return u}});var n=s(641);const o={id:"qr_container"},a=["src"];function r(t,e,s,r,i,l){return(0,n.uX)(),(0,n.CE)(n.FK,null,[e[0]||(e[0]=(0,n.Lk)("h4",null,"Platba cez QR kód",-1)),(0,n.Lk)("div",o,[(0,n.Lk)("img",{src:l.qr_code,class:"qr_code"},null,8,a)])],64)}var i=s(7004),l={props:{},components:{},emits:[],data(){return{base64:""}},created(){i.A.generate_qr().then((t=>{200===t.status&&(this.base64=t.result.pbs)}))},methods:{},computed:{qr_code(){return this.base64?"data:image/png;base64,"+this.base64:""}},watch:{}},c=s(6262);const d=(0,c.A)(l,[["render",r]]);var u=d},6804:function(t,e,s){s.d(e,{A:function(){return p}});var n=s(641),o=s(33);const a=["data-cy"],r={class:"d-flex point-head"},i={class:"flex-shrink-0 point-number"},l={class:"flex-grow-1"},c={class:"point-body"};function d(t,e,s,d,u,_){return(0,n.uX)(),(0,n.CE)("div",{class:"col-12 point-box","data-cy":"point_"+s.order},[(0,n.Lk)("div",r,[(0,n.Lk)("div",i,[(0,n.Lk)("span",{class:(0,o.C4)("i_next_step"+s.order)},null,2)]),(0,n.Lk)("div",l,[(0,n.Lk)("h3",null,(0,o.v_)(s.title),1)])]),(0,n.Lk)("div",c,[(0,n.RG)(t.$slots,"default")])],8,a)}var u={props:{order:Number,title:String},components:{},emits:[],data(){return{}},created(){},methods:{},computed:{},watch:{}},_=s(6262);const m=(0,_.A)(u,[["render",d]]);var p=m},9713:function(t,e,s){s.d(e,{A:function(){return _}});var n=s(641),o=s(33);const a={class:"calc_title_area"},r={class:"text-primary"},i={key:0,class:"mb-3"};function l(t,e,s,l,c,d){return(0,n.uX)(),(0,n.CE)("div",a,[(0,n.Lk)("h2",r,(0,o.v_)(s.title),1),s.subtitle?((0,n.uX)(),(0,n.CE)("p",i,(0,o.v_)(s.subtitle),1)):(0,n.Q3)("",!0),(0,n.RG)(t.$slots,"default")])}var c={props:{title:String,subtitle:String},components:{},emits:[],data(){return{}},created(){},methods:{},computed:{},watch:{}},d=s(6262);const u=(0,d.A)(c,[["render",l]]);var _=u},7307:function(t,e,s){s.r(e),s.d(e,{default:function(){return R}});var n=s(641);const o={"data-cy":"calc_payment"},a={key:0,class:"row gx-3 gy-3"},r={class:"row"},i={class:"col-md-4 mb-3 mb-md-0"},l={class:"col-sm-6 col-md-4 mb-3 mb-md-0"},c={class:"col-sm-6 col-md-4"},d=["innerHTML"],u={class:"col-12 px-0 mt-5","data-cy":"docs_landing"},_={class:"row"},m={class:"col-12 mb-5 text-center"};function p(t,e,s,p,h,g){const k=(0,n.g2)("Title"),y=(0,n.g2)("Gateways"),v=(0,n.g2)("Info"),w=(0,n.g2)("Qr"),b=(0,n.g2)("Point"),f=(0,n.g2)("Documents_prepare"),A=(0,n.g2)("Docs_template");return(0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.Lk)("section",o,[(0,n.bF)(k,{title:g.title,subtitle:g.subtitle},null,8,["title","subtitle"]),null!==h.success&&"ERROR"!==h.success?((0,n.uX)(),(0,n.CE)("div",a,[!0!==h.success?((0,n.uX)(),(0,n.Wv)(b,{key:0,order:1,title:"Uhradiť poistenie"},{default:(0,n.k6)((()=>[(0,n.Lk)("div",r,[(0,n.Lk)("div",i,[h.start_doc_requests?((0,n.uX)(),(0,n.Wv)(y,{key:0})):(0,n.Q3)("",!0)]),(0,n.Lk)("div",l,[h.start_doc_requests?((0,n.uX)(),(0,n.Wv)(v,{key:0})):(0,n.Q3)("",!0)]),(0,n.Lk)("div",c,[h.start_doc_requests?((0,n.uX)(),(0,n.Wv)(w,{key:0})):(0,n.Q3)("",!0)])])])),_:1})):(0,n.Q3)("",!0),(0,n.bF)(b,{order:h.success?1:2,title:"Uložiť dokumenty"},{default:(0,n.k6)((()=>[(0,n.bF)(f,{start_doc_requests:h.start_doc_requests,step_html:6},null,8,["start_doc_requests"])])),_:1},8,["order"]),(0,n.bF)(b,{order:h.success?2:3,title:"E-mail a ďalšie inštrukcie"},{default:(0,n.k6)((()=>[(0,n.Lk)("div",{innerHTML:h.view_confirm_text},null,8,d)])),_:1},8,["order"]),(0,n.Lk)("div",u,[h.load_docs_landing_section?((0,n.uX)(),(0,n.Wv)(A,{key:0})):(0,n.Q3)("",!0)])])):(0,n.Q3)("",!0)]),(0,n.Lk)("div",_,[(0,n.Lk)("div",m,[(0,n.Lk)("button",{onClick:e[0]||(e[0]=(...t)=>g.clear&&g.clear(...t)),type:"button",class:"btn btn-primary btn-lg btn-left"}," Vytvoriť nové porovnanie ")])])],64)}s(4979),s(1678);var h=s(8700),g=s(4001),k=s(1050),y=s(5116),v=s(132),w=s(9452),b=s(3177),f=s(8856),A=s(9713),L=s(6804),x=s(7004),E=s(4854),X=s(2873),C={props:{},components:{Documents_prepare:g.A,Gateways:k.A,Info:y.A,Qr:v.A,Title:A.A,Point:L.A,Payment_requests:x.A,Docs_template:E["default"]},emits:[],data(){return{success:null,start_doc_requests:!1,view_confirm_text:"",load_docs_landing_section:!1}},created(){Promise.resolve().then((()=>w.A.get_data())).then((t=>{(0,b.A)().extract_selected_product(t),(0,b.A)().store_call_params(t.result?.call_params),this.start_doc_requests=!0})).then((()=>{f.A.get_it("view_confirm_text").then((t=>{this.view_confirm_text=t.result?.html})),f.A.get_it("view_confirm_docs_landing").then((t=>{t.result?.html&&t.result?.html.indexOf('id="osm_app"')>-1&&(this.load_docs_landing_section=!0)}))}));let t=(0,h.A)().get_payment_data();if(!t.payment_id||!t.payment_result)return console.log("ERROR: payment is empty",structuredClone(t)),void(this.success="ERROR");x.A.payment_result(t.payment_id,t.payment_result).then((t=>{console.log(t.result),this.success=20===t.result.payment_state}))},methods:{clear(){(0,X.A)().open_it("Cleaning_session")}},computed:{title(){return null===this.success?"Spracovávam platobnú informáciu...":"ERROR"===this.success?"Platobnú informáciu sa nepodarilo získať. Prosím kontaktuje administrátora.":this.success?"Platba úspešná!":"Platba neúspešná!"},subtitle(){return null===this.success||"ERROR"===this.success?"":this.success?"Gratulujeme! Vaša zmluva je platná.":"Platba nebola úspešná alebo informácia a zrealizovaní platby je nedostupná. Prosím skontrolujte si výsledok cez internetbanking."}},watch:{}},q=s(6262);const P=(0,q.A)(C,[["render",p]]);var R=P}}]);