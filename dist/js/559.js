"use strict";(self["webpackChunkosmapp_webpack_3x25x"]=self["webpackChunkosmapp_webpack_3x25x"]||[]).push([[559],{4326:function(e,t,a){var l=a(8700),o=a(6343),i=a(3175),r=a(3177);class s{get_calculate(e,t,a){let r={action_name:"calculate_step2",method:"POST",url:(0,l.A)().endpoint_url()+"online/calculate/?id="+e+"&json=1&period="+a+o.A.add_token_as_parameter(),body:t},s=new i.A;return s.prepare_params(r).handle_response().then(t=>408===t.status?(console.log("#"+e+" has 408, going for results request"),this.repeat_results()):t).catch(e=>{throw e})}check_calculate(){let e={action_name:"calculate_step4",method:"POST",url:(0,l.A)().endpoint_url()+"online/calculate/?"+o.A.add_token_as_parameter(),body:null};e.url+="&id="+(0,r.A)().get_selected_product().product_id+"&period="+(0,r.A)().get_selected_product().period;let t=new i.A;return t.prepare_params(e).handle_response().then(async e=>408===e.status?(console.log("calculate has 408 timeout, wait 1 minute and run results api"),await o.A.sleep(60),this.repeat_results()):e).catch(e=>{throw e})}repeat_results(){let e={action_name:"results",method:"GET",url:(0,l.A)().endpoint_url()+"online/results/?"+o.A.add_token_as_parameter()},t=new i.A;return t.prepare_params(e).handle_response().catch(e=>{throw e})}}t.A=new s},7663:function(e,t,a){a.r(t),a.d(t,{default:function(){return Vt}});var l=a(641),o=a(3751);const i={"data-cy":"calc_results"},r={class:"results_action_area"},s={style:{position:"relative"}},d={key:1,"data-cy":"product_list"};function _(e,t,a,_,n,c){const p=(0,l.g2)("Step_title"),u=(0,l.g2)("Summary"),h=(0,l.g2)("Global_form"),b=(0,l.g2)("Filters"),g=(0,l.g2)("Product_delivery"),m=(0,l.g2)("Price_form"),f=(0,l.g2)("Bouncer_loading"),v=(0,l.g2)("Product_template");return(0,l.uX)(),(0,l.CE)("section",i,[c.classic_np_nav?((0,l.uX)(),(0,l.Wv)(p,{key:0,loaded:n.loaded,total:n.total,disable_email_pdf:n.disable_email_pdf,disable_offer:n.disable_offer},null,8,["loaded","total","disable_email_pdf","disable_offer"])):(0,l.Q3)("",!0),(0,l.Lk)("div",r,[(0,l.bF)(u,{user_data:c.user_data},null,8,["user_data"]),(0,l.bF)(h,{global_disabled:n.global_disabled,global_inputs:n.global_inputs,global_errors:n.global_errors,onValidate_global_changed:c.validate_global_changed},null,8,["global_disabled","global_inputs","global_errors","onValidate_global_changed"]),c.display_filters?((0,l.uX)(),(0,l.Wv)(b,{key:0,got_products:n.got_products,nice_filter_label:n.nice_filter_label,filtered_array:c.filtered_array,options_inputs:n.options_inputs,disabled_from_calculate:n.disabled_from_calculate,global_disabled:n.global_disabled,product_rates:n.product_rates,onCalculate_all_products:c.calculate_all_products,onFilters_run_own_validate:c.filters_run_own_validate,onOptions_value_changed:c.options_value_changed},null,8,["got_products","nice_filter_label","filtered_array","options_inputs","disabled_from_calculate","global_disabled","product_rates","onCalculate_all_products","onFilters_run_own_validate","onOptions_value_changed"])):(0,l.Q3)("",!0),c.classic_np_nav?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(g,{key:1})),n.ready_price?((0,l.uX)(),(0,l.Wv)(m,{key:2,global_disabled:n.global_disabled,price_inputs:n.price_inputs,global_errors:n.global_errors,onValidate_global_changed:c.validate_global_changed},null,8,["global_disabled","price_inputs","global_errors","onValidate_global_changed"])):(0,l.Q3)("",!0)]),(0,l.bo)((0,l.Lk)("div",s,[(0,l.bF)(f,{size:"small",style:{position:"absolute",top:"-28px",left:"50%",transform:"translateX(-50%)"}})],512),[[o.aG,n.global_disabled]]),t[0]||(t[0]=(0,l.Lk)("span",{class:"product_list_scroll_anchor"},null,-1)),n.valid_global_show_products?((0,l.uX)(),(0,l.CE)("div",d,[(0,l.bF)(o.F,{name:"product_shuffle"},{default:(0,l.k6)(()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(c.only_displayed_products,e=>((0,l.uX)(),(0,l.Wv)(v,{key:e,product_id:e,product_name:n.got_products[e],response:n.raw_responses[e],being_calculated:n.being_calculated,being_selected:n.being_selected,delegate_product_select:n.delegate_product_select,solid_product_parts:n.solid_product_parts,onRecalculate_product:c.recalculate_product,onSelect_running:c.select_running},null,8,["product_id","product_name","response","being_calculated","being_selected","delegate_product_select","solid_product_parts","onRecalculate_product","onSelect_running"]))),128))]),_:1})])):(0,l.Q3)("",!0)])}a(4114),a(4979),a(1678);const n={class:"results_deliver"},c={key:1,class:"i_download"};function p(e,t,a,o,i,r){const s=(0,l.g2)("Bouncer_loading");return(0,l.uX)(),(0,l.CE)("div",n,[r.allow_email_modal&&!a.disable_email_pdf?((0,l.uX)(),(0,l.CE)("button",{key:0,onClick:t[0]||(t[0]=(...e)=>r.open_email_modal&&r.open_email_modal(...e)),class:"btn-text i_anchor"},t[2]||(t[2]=[(0,l.Lk)("span",{class:"i_email"},null,-1),(0,l.eW)(" poslať e-mailom ")]))):(0,l.Q3)("",!0),a.disable_offer?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("button",{key:1,onClick:t[1]||(t[1]=(...e)=>r.download_pdf&&r.download_pdf(...e)),class:"btn-text i_anchor"},[i.downloading_pdf?((0,l.uX)(),(0,l.Wv)(s,{key:0,size:"small"})):((0,l.uX)(),(0,l.CE)("span",c)),t[3]||(t[3]=(0,l.eW)(" stiahnuť pdf "))]))])}var u=a(8700),h=a(6343),b=a(9819),g=a(3175);class m{download_global_pdf(){let e={action_name:"getpdf",method:"POST",url:(0,u.A)().endpoint_url()+"online/getpdf/?&id="+b.A.group_offer()+h.A.add_token_as_parameter()},t=new g.A;return t.prepare_params(e).handle_response().catch(e=>{throw e})}}var f=new m,v=a(55),k=a(2873),y=a(3177),x={props:{disable_email_pdf:Boolean,disable_offer:Boolean},components:{Bouncer_loading:v.A},emits:[],data(){return{downloading_pdf:!1}},created(){},methods:{download_pdf(){this.downloading_pdf||(this.downloading_pdf=!0,f.download_global_pdf().then(e=>{this.downloading_pdf=!1,200===e.status&&h.A.downloadBase64("Ponuka.pdf",e.result.pdf)}))},open_email_modal(){(0,k.A)().open_it("Email_offer")}},computed:{allow_email_modal(){let e=(0,y.A)().get_receiver();return 4!==e}},watch:{}},A=a(6262);const w=(0,A.A)(x,[["render",p]]);var C=w,L=a(33);const X=["id"],E={class:"col-lg-10 pr_area_info pb-2 pb-lg-1 position-relative"},O={class:"pr_ribbon"},j={class:"pr_top"},W={class:"row g-0"},F={class:"col-lg-2"},I={class:"pr_box_logo text-center mb-2 mb-lg-0"},Q=["src"],P={class:"col-lg-4"},T={class:"pr_box_name text-center text-lg-start"},S=["id"],z={key:0,class:"pr_rating"},G={class:"pr_select"},V={key:0},B={class:"detail-compare text-nowrap"},$={class:"pr_detail"},R={class:"col-lg-6"},K={class:"pr_box_overview"},N=["innerHTML"],q={class:"pr_bottom"},U={class:"row g-0"},H={class:"col-lg-6"},M={class:"pr_box_included"},D={class:"col-lg-6"},Y={class:"pr_box_options"},Z={key:5},J={class:"text-center my-3"},ee=["id"],te={class:"col-lg-2"},ae={class:"pr_area_price d-flex flex-column flex-sm-row flex-lg-column text-center h-100"},le={class:"pr_discount"},oe={key:0,class:"before_discount"},ie={key:1,class:"discount_tag"},re={class:"amount"},se={class:"text-default"},de={class:"period"},_e={class:"pr_price"},ne={class:"pr_cta"},ce={key:0,class:"btn btn-inactive w-100"},pe={key:1,class:"btn btn-inactive w-100"},ue={key:2,class:"btn btn-inactive w-100"},he=["disabled"],be=["disabled"],ge=["disabled"],me=["disabled"],fe={key:7,class:"btn btn-inactive w-100"},ve=["disabled"],ke={key:9};function ye(e,t,a,i,r,s){const d=(0,l.g2)("Select"),_=(0,l.g2)("Tooltip"),n=(0,l.g2)("Checkbox"),c=(0,l.g2)("Multiple"),p=(0,l.g2)("Datepicker"),u=(0,l.g2)("Plaintext"),h=(0,l.g2)("Bouncer_loading");return(0,l.uX)(),(0,l.CE)("div",{id:"product_"+a.product_id,class:(0,L.C4)([s.show_loading_animation?"the_form_is_disabled":"","row product g-0"]),"data-cy":"product"},[(0,l.Lk)("div",E,[(0,l.bo)((0,l.Lk)("div",O,t[9]||(t[9]=[(0,l.Lk)("span",null,"NÁŠ TIP",-1)]),512),[[o.aG,"1"===r.p_data.product.promo&&"2"===r.p_data.product.promo]]),(0,l.Lk)("div",j,[(0,l.Lk)("div",W,[(0,l.Lk)("div",F,[(0,l.Lk)("div",I,[(0,l.Lk)("img",{src:r.p_data.logo},null,8,Q)])]),(0,l.Lk)("div",P,[(0,l.Lk)("div",T,[(0,l.Lk)("h4",{id:"#"+a.product_id},(0,L.v_)(a.product_name),9,S),s.not_zeteo_product?(0,l.bo)(((0,l.uX)(),(0,l.CE)("div",z,[((0,l.uX)(),(0,l.CE)(l.FK,null,(0,l.pI)(5,e=>(0,l.Lk)("span",{class:(0,L.C4)([e>r.p_data.product.stars?"i_star_empty":"i_star"])},null,2)),64))],512)),[[o.aG,r.p_data.product.stars>0]]):(0,l.Q3)("",!0),(0,l.bo)((0,l.Lk)("div",G,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.p_data.spoluucast_krytie,(e,t)=>((0,l.uX)(),(0,l.Wv)(d,{field_id:t,field_data:e,emit_name:"recalculate_product",onRecalculate_product:s.recalculate_product},null,8,["field_id","field_data","onRecalculate_product"]))),256)),r.p_data.product.spoluucast_text&&!r.p_data.spoluucast_krytie?((0,l.uX)(),(0,l.CE)("p",V,(0,L.v_)(r.p_data.product.spoluucast_text),1)):(0,l.Q3)("",!0)],512),[[o.aG,r.p_data.spoluucast_krytie||r.p_data.product.spoluucast_text]]),(0,l.Lk)("div",B,[(0,l.bo)((0,l.Lk)("span",$,[(0,l.bo)((0,l.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>s.open_product_detail&&s.open_product_detail(...e)),class:"btn-text i_anchor"},t[10]||(t[10]=[(0,l.Lk)("span",{class:"i_detail"},null,-1),(0,l.eW)(" info o produkte ")]),512),[[o.aG,"2"===r.p_data.product.detail_pdf]])],512),[[o.aG,a.solid_product_parts]])])])]),t[11]||(t[11]=(0,l.Lk)("hr",{class:"pr_divider d-block d-lg-none"},null,-1)),(0,l.Lk)("div",R,[(0,l.bo)((0,l.Lk)("div",K,[(0,l.Lk)("ul",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.p_data.icons,e=>((0,l.uX)(),(0,l.CE)("li",{class:(0,L.C4)(e.class)},[(0,l.Lk)("span",{innerHTML:e.title,class:"bold_move_to_side"},null,8,N),(0,l.bF)(_,{tooltip_text:e.tooltip,tooltip_type:"cost"},null,8,["tooltip_text"])],2))),256))])],512),[[o.aG,a.solid_product_parts]])])])]),t[15]||(t[15]=(0,l.Lk)("hr",{class:"pr_divider"},null,-1)),(0,l.Lk)("div",q,[(0,l.Lk)("div",U,[(0,l.Lk)("div",H,[(0,l.Lk)("div",M,[(0,l.Lk)("ul",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.p_data.benefits,e=>((0,l.uX)(),(0,l.CE)("li",{class:(0,L.C4)(e.class)},(0,L.v_)(e.title),3))),256))])])]),t[13]||(t[13]=(0,l.Lk)("hr",{class:"pr_divider d-block d-lg-none"},null,-1)),(0,l.Lk)("div",D,[(0,l.Lk)("div",Y,[(0,l.Lk)("ul",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.p_data.card_inputs,(e,a)=>((0,l.uX)(),(0,l.CE)("li",null,[(0,l.Lk)("div",{class:(0,L.C4)(r.validation_highlight.error&&r.validation_highlight.input_name===a?"product_highlight":"")},["checkbox"===e.type?((0,l.uX)(),(0,l.Wv)(n,{key:0,field_id:a,field_data:e,emit_name:"recalculate_product",onRecalculate_product:s.recalculate_product},null,8,["field_id","field_data","onRecalculate_product"])):"select"===e.type&&"multiple"!==e.type_settings?.select_type?((0,l.uX)(),(0,l.Wv)(d,{key:1,field_id:a,field_data:e,emit_name:"recalculate_product",onRecalculate_product:s.recalculate_product},null,8,["field_id","field_data","onRecalculate_product"])):"select"===e.type&&"multiple"===e.type_settings?.select_type?((0,l.uX)(),(0,l.Wv)(c,{key:2,field_id:a,field_data:e,emit_name:"recalculate_product",onRecalculate_product:s.recalculate_product},null,8,["field_id","field_data","onRecalculate_product"])):"date"===e.type?((0,l.uX)(),(0,l.Wv)(p,{key:3,field_id:a,field_data:e,emit_name:"recalculate_product",onRecalculate_product:s.recalculate_product},null,8,["field_id","field_data","onRecalculate_product"])):"plaintext"===e.type?((0,l.uX)(),(0,l.Wv)(u,{key:4,field_id:a,field_data:e,in_product:!0},null,8,["field_id","field_data"])):((0,l.uX)(),(0,l.CE)("p",Z,[(0,l.Lk)("strong",null,(0,L.v_)(a),1),t[12]||(t[12]=(0,l.eW)(" unsupported type"))]))],2)]))),256))]),(0,l.Lk)("div",J,[r.p_data.extended_opener?((0,l.uX)(!0),(0,l.CE)(l.FK,{key:0},(0,l.pI)(r.p_data.extended_opener,(e,a)=>((0,l.uX)(),(0,l.CE)("button",{id:a,onClick:t[1]||(t[1]=(...e)=>s.open_extended&&s.open_extended(...e)),class:(0,L.C4)(["btn-text i_anchor",r.p_data.extended_errors?"text-accent":""])},[(0,l.Lk)("span",{class:(0,L.C4)(["i_settings",r.p_data.extended_errors?"i_settings_error":""])},null,2),(0,l.eW)(" "+(0,L.v_)(e.label)+(0,L.v_)(r.p_data.extended_errors?" - CHYBA!":""),1)],10,ee))),256)):(0,l.Q3)("",!0)])])])]),r.p_data.product.crossell_text?((0,l.uX)(),(0,l.CE)("div",{key:0,class:(0,L.C4)(["pr_bundle",r.validation_highlight.error?"product_highlight":""])},[t[14]||(t[14]=(0,l.Lk)("span",{class:"bundle_img"},null,-1)),(0,l.Lk)("p",null,(0,L.v_)(r.p_data.product.crossell_text),1),r.p_data.product.crossell_cta&&"2"===r.p_data.product.detail_pdf?((0,l.uX)(),(0,l.CE)("span",{key:0,onClick:t[2]||(t[2]=(...e)=>s.open_product_detail&&s.open_product_detail(...e)),class:"bundle_cta"},(0,L.v_)(r.p_data.product.crossell_cta),1)):(0,l.Q3)("",!0)],2)):(0,l.Q3)("",!0)])]),(0,l.Lk)("div",te,[(0,l.Lk)("div",ae,[(0,l.bo)((0,l.Lk)("div",le,[r.p_data.price.base?((0,l.uX)(),(0,l.CE)("span",oe,(0,L.v_)(r.p_data.price.base)+"€ ",1)):(0,l.Q3)("",!0),r.p_data.price.discount?((0,l.uX)(),(0,l.CE)("span",ie,(0,L.v_)(r.p_data.price.discount),1)):(0,l.Q3)("",!0)],512),[[o.aG,a.solid_product_parts]]),(0,l.bo)((0,l.Lk)("div",{onClick:t[3]||(t[3]=(...e)=>s.get_price_ws_details&&s.get_price_ws_details(...e)),class:(0,L.C4)(["pr_price",s.dont_allow_limity?"":"price_has_details"])},[(0,l.Lk)("span",re,(0,L.v_)(r.p_data.price.for_period),1),(0,l.Lk)("span",se,(0,L.v_)(r.p_data.price.currency),1),(0,l.Lk)("span",de,(0,L.v_)(r.p_data.price.period_label),1)],2),[[o.aG,!s.show_loading_animation&&r.p_data.price.for_period&&a.solid_product_parts]]),(0,l.bo)((0,l.Lk)("div",_e,[(0,l.bF)(h)],512),[[o.aG,s.show_loading_animation]]),(0,l.bo)((0,l.Lk)("div",ne,[a.solid_product_parts?r.p_data.error.errors?((0,l.uX)(),(0,l.CE)("span",pe,[(0,l.Lk)("span",{class:(0,L.C4)(r.p_data.error.alt_text?"viacinfo":"")},(0,L.v_)(r.p_data.error.alt_text?"VIAC INFO":"Nedá sa poistiť"),3),(0,l.bF)(_,{tooltip_text:r.p_data.error.errors,tooltip_type:"info"},null,8,["tooltip_text"])])):null!==r.p_data.extended_errors?((0,l.uX)(),(0,l.CE)("span",ue,[(0,l.Lk)("span",{class:(0,L.C4)(r.p_data.error.alt_text?"viacinfo":"")}," Treba upraviť ",2),(0,l.bF)(_,{tooltip_text:s.print_ex_errors,tooltip_type:"info"},null,8,["tooltip_text"])])):"6"===r.p_data.button.show?((0,l.uX)(),(0,l.CE)("button",{key:3,onClick:t[4]||(t[4]=(...e)=>s.open_lead_contact&&s.open_lead_contact(...e)),disabled:a.being_selected,class:"btn btn-xlg btn-right btn-accent w-100"}," Vybrať ",8,he)):"5"===r.p_data.button.show?((0,l.uX)(),(0,l.CE)("button",{key:4,onClick:t[5]||(t[5]=(...e)=>s.open_specify&&s.open_specify(...e)),disabled:a.being_selected,class:"btn btn-xlg btn-right btn-accent w-100"}," Vybrať ",8,be)):"4"===r.p_data.button.show?((0,l.uX)(),(0,l.CE)("button",{key:5,onClick:t[6]||(t[6]=(...e)=>s.validate_then_select&&s.validate_then_select(...e)),disabled:a.being_selected,class:"btn btn-xlg btn-right btn-accent w-100"},(0,L.v_)(s.not_zeteo_product?"Vybrať":"Uzatvoriť"),9,ge)):"3"===r.p_data.button.show?((0,l.uX)(),(0,l.CE)("button",{key:6,onClick:t[7]||(t[7]=(...e)=>s.redirect_to_product&&s.redirect_to_product(...e)),disabled:a.being_selected,class:"btn btn-xlg btn-right btn-accent w-100"},(0,L.v_)(s.not_zeteo_product?"Vybrať":"Uzatvoriť"),9,me)):"2"===r.p_data.button.show?((0,l.uX)(),(0,l.CE)("span",fe,[(0,l.Lk)("span",{class:(0,L.C4)(r.p_data.error.alt_text?"viacinfo":"")},(0,L.v_)(r.p_data.error.alt_text?"VIAC INFO":"Nedá sa poistiť"),3),(0,l.bF)(_,{tooltip_text:r.p_data.error.info,tooltip_type:"info"},null,8,["tooltip_text"])])):"1"===r.p_data.button.show?((0,l.uX)(),(0,l.CE)("button",{key:8,onClick:t[8]||(t[8]=(...e)=>s.select_this_product&&s.select_this_product(...e)),disabled:a.being_selected,class:"btn btn-xlg btn-right btn-accent w-100"},(0,L.v_)(s.not_zeteo_product?"Vybrať":"Uzatvoriť"),9,ve)):(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("span",ce,[(0,l.Lk)("span",{class:(0,L.C4)(r.p_data.error.alt_text?"viacinfo":"")}," Treba prepočítať ",2),(0,l.bF)(_,{tooltip_text:"Zmenili sa hodnoty vo formulári 'vlastnosti' produktov. Kliknite na tlačidlo 'Prepočítať zmeny' aby sme získali správne údaje o produktoch.",tooltip_type:"info"})])),"1"===r.p_data.button.show&&r.p_data.product.warning&&null===r.p_data.extended_errors&&!r.p_data.error.errors?((0,l.uX)(),(0,l.CE)("div",ke,[(0,l.bF)(_,{tooltip_text:r.p_data.product.warning,tooltip_type:"warning"},null,8,["tooltip_text"])])):(0,l.Q3)("",!0)],512),[[o.aG,!s.show_loading_animation]])])])],10,X)}class xe{get_product_list(){let e={action_name:"getproducts",method:"GET",url:(0,u.A)().endpoint_url()+"online/getproducts/"+(0,u.A)().product_group_id()+"/?"+h.A.add_token_as_parameter()},t=new g.A;return t.prepare_params(e).handle_response().catch(e=>{throw e})}select_product(){let e={action_name:"productselect",method:"GET",url:(0,u.A)().endpoint_url()+"online/productselect/"+(0,y.A)().get_selected_product().product_id+"/?"+h.A.add_token_as_parameter()};e.url+="&"+h.A.serialize_object((0,y.A)().get_selected_product());let t=new g.A;return t.prepare_params(e).handle_response().catch(e=>{throw e})}}var Ae=new xe,we=a(5162),Ce=a(1602),Le=a(3358),Xe=a(4211),Ee=a(43),Oe=a(4871),je=a(9452),We=(a(8856),a(2095)),Fe=a(2050),Ie=a(3886),Qe={props:{product_id:String,product_name:String,response:Object,being_calculated:Array,being_selected:Boolean,delegate_product_select:Number,solid_product_parts:Boolean},components:{Checkbox:Ce.A,Select:Le.A,Multiple:Xe.A,Datepicker:Ee.A,Plaintext:Oe.A,Bouncer_loading:v.A,Tooltip:We.A},emits:["recalculate_product","select_running"],data(){return{loading:!0,validation_highlight:{error:!1,input_name:""},p_data:{logo:"",error:{errors:"",alt_text:!1,info:""},button:{show:"0",next_form:"",next_contract:"",next_redirect:"",validation_codition_old:"",validation_codition_new:"",filter_price_inputs:null},price:{for_period:"",currency:"",period_label:"",base:"",discount:""},product:{promo:"",stars:0,spoluucast_text:"",detail_pdf:"",detail_template:"",crossell_text:"",crossell_cta:"",warning:"",limity:"0"},icons:[],benefits:[{title:"",class:""}],spoluucast_krytie:!1,card_inputs:!1,calc_documents:{},extended_inputs:null,extended_errors:null,extended_opener:!1}}},created(){this.asign_values()},methods:{asign_values(){if("object"!==typeof this.response)return void Object.assign(this.$data,this.$options.data());let e=this.response.result[this.product_id].result,t=we.A.find_period(this.response);this.p_data={logo:e?.head?.logo?.comment,period:t,error:{errors:we.A.error_tooltip(e),alt_text:we.A.check_alt_text(),info:we.A.info_tooltip(e)},price:{for_period:we.A.price_for_period(e,t),currency:e?.result?.currency?.result||"€",period_label:we.A.label_for_period(e,t),base:e?.result?.base?.result,discount:e?.result?.discount?.result},button:{show:e?.next?.next?.result,next_form:e?.next?.next_form?.result,next_contract:e?.next?.next_contract_html?.result,next_redirect:e?.next?.next_redirect?.result,validation_codition_old:e?.next?.next?.comment,validation_codition_new:e?.next?.next_validation?.result,filter_price_inputs:e?.next?.next_global?.result||null},product:{promo:e?.product?.promo?.result,stars:parseInt(e?.product?.stars?.result,10),spoluucast_text:e?.product?.spoluucast?.formula_name,detail_pdf:e?.product?.detail?.result,detail_template:e?.product?.detail?.comment,crossell_text:we.A.crossell_text(e?.product?.crossell),crossell_cta:we.A.crossell_cta(e?.product?.crossell),warning:e?.result?.warning?.result,limity:e?.product?.limity?.result||"0"},icons:we.A.sort_icons(e?.icon),benefits:we.A.sort_benefits(e?.benefit),spoluucast_krytie:we.A.product_form_formatter(e?.results_form?.comment,"spoluucast"),card_inputs:we.A.product_form_formatter(e?.results_form?.comment,"product"),calc_documents:we.A.format_calculate_docs(this.response.result[this.product_id].documents),extended_inputs:we.A.extended_form_formatter(e?.results_form_v2?.comment),extended_errors:we.A.flatten_extended_errors(this.response,e?.results_form?.comment),extended_opener:we.A.product_form_formatter(e?.results_form?.comment,"extended")},this.loading=!1},select_this_product(){(0,u.A)().is_read_only()?(0,u.A)().change_step(3):(this.loading=!0,this.$emit("select_running",!0),(0,y.A)().set_selected_product(this.product_id,this.p_data.button.next_form,this.p_data.button.next_contract,this.p_data.period,this.product_name,this.p_data.price.for_period),Ae.select_product().then(e=>{if(200!==e.status||"success"!==e.result.response)return this.loading=!1,void this.$emit("select_running",!1);(0,u.A)().change_step(3)}))},redirect_to_product(){this.p_data.button.next_redirect?((0,y.A)().set_selected_product(this.product_id,this.p_data.button.next_form,this.p_data.button.next_contract,this.p_data.period,this.product_name,this.p_data.price.for_period),Fe.A.send_event("product_redirect"),window.open(this.p_data.button.next_redirect,"_blank").focus()):console.log(this.product_id+" next_redirect is undefined")},open_product_detail(){(0,y.A)().set_selected_product(this.product_id,null,null,null,null,null),(0,k.A)().store_modal_data({product_name:this.product_name,detail_template:this.p_data.product.detail_template}),(0,k.A)().open_it("Product_detail")},open_extended(){(0,k.A)().store_modal_data({extended_inputs:this.p_data.extended_inputs,extended_errors:this.p_data.extended_errors,product_name:this.product_name,product_id:this.product_id,period:this.p_data.period}),(0,k.A)().open_it("Extended_product_settings")},open_specify(){(0,k.A)().store_modal_data({product_id:this.product_id,price_inputs:{},price_errors:{},filter_price_inputs:this.p_data.button.filter_price_inputs}),(0,k.A)().open_it("Specify_product_price")},open_lead_contact(){(0,k.A)().open_it("Lead_contact")},recalculate_product(){this.$emit("recalculate_product",this.product_id)},get_price_ws_details(){if(!this.dont_allow_limity)if(this.loading=!0,"1"===this.p_data.product.limity)je.A.set_data({product_template_identifier:this.product_id}).then(()=>{(0,k.A)().open_it("Product_ws_details"),this.loading=!1});else if("2"===this.p_data.product.limity)for(let e in this.p_data.calc_documents)Ie.A.get_session_document(this.p_data.calc_documents[e].id).then(t=>{200===t.status?(h.A.downloadBase64(this.p_data.calc_documents[e].name,t.result.content),this.loading=!1):this.loading=!1})},validate_then_select(){let e=structuredClone(this.p_data.button.validation_codition_old);e||(e=structuredClone(this.p_data.button.validation_codition_new)),this.validation_highlight=we.A.validate_product(e),this.validation_highlight.error||this.select_this_product(),setTimeout(()=>{this.validation_highlight.error=!0},0),setTimeout(()=>{this.validation_highlight.error=!1},500),setTimeout(()=>{this.validation_highlight.error=!0},1e3),setTimeout(()=>{this.validation_highlight.error=!1},1500),setTimeout(()=>{this.validation_highlight.error=!0},2e3),setTimeout(()=>{this.validation_highlight.error=!1},2500)}},computed:{show_loading_animation(){let e=this.being_calculated.indexOf(this.product_id);return this.being_calculated[e]||this.loading},dont_allow_limity(){return this.p_data.error.errors||!["1","2"].includes(this.p_data.product.limity)},not_zeteo_product(){return!(0,u.A)().is_zeteo_skin()},print_ex_errors(){let e="Nastala chyba v Individuálnych nastaveniach. <br> Otvorte prosím Individálne nastavenia a upravte zvýraznené hodnoty <br><br>";for(let t in this.p_data.extended_errors){e+="<br><b>"+t+": </b><br>";for(let a in this.p_data.extended_errors[t])e+=this.p_data.extended_errors[t][a]+"<br>"}return e}},watch:{response(){this.asign_values()},delegate_product_select(){this.delegate_product_select===this.product_id&&this.select_this_product()}}};const Pe=(0,A.A)(Qe,[["render",ye]]);var Te=Pe;const Se={class:"calc_title_area","data-cy":"title"},ze={key:0},Ge={key:1},Ve=["title"];function Be(e,t,a,o,i,r){const s=(0,l.g2)("Product_delivery");return(0,l.uX)(),(0,l.CE)("div",Se,[0===a.loaded?((0,l.uX)(),(0,l.CE)("h2",ze," Hľadáme produkty... ")):((0,l.uX)(),(0,l.CE)("h2",Ge,[t[0]||(t[0]=(0,l.eW)(" Našli sme ")),(0,l.Lk)("span",{title:"z "+a.total+" prepočítavaných",class:"text-accent"},(0,L.v_)(r.products_found),9,Ve)])),(0,l.bF)(s,{disable_email_pdf:a.disable_email_pdf,disable_offer:a.disable_offer},null,8,["disable_email_pdf","disable_offer"])])}var $e={props:{loaded:Number,total:Number,disable_email_pdf:Boolean,disable_offer:Boolean},components:{Product_delivery:C},data(){return{}},created(){},methods:{},computed:{products_found(){return 1===this.loaded?this.loaded+" produkt":this.loaded>1&&this.loaded<5?this.loaded+" produkty":this.loaded+" produktov"}}};const Re=(0,A.A)($e,[["render",Be]]);var Ke=Re;const Ne={class:"d-flex align-items-stretch form_summary","data-cy":"summary"},qe={class:"w-100 data_summary"},Ue={class:"d-flex flex-shrink-1 data_edit"};function He(e,t,a,o,i,r){return(0,l.uX)(),(0,l.CE)("div",Ne,[(0,l.Lk)("div",qe,[t[1]||(t[1]=(0,l.Lk)("strong",null,"Vaše údaje:",-1)),(0,l.eW)(" "+(0,L.v_)(a.user_data),1)]),(0,l.Lk)("div",Ue,[(0,l.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>r.go_back&&r.go_back(...e)),class:"btn-text i_anchor my-auto"},t[2]||(t[2]=[(0,l.Lk)("span",{class:"i_edit"},null,-1),(0,l.Lk)("span",{class:"d-none d-sm-inline"},"upraviť",-1)]))])])}var Me=a(9614),De={props:{user_data:String},components:{},data(){return{}},created(){},methods:{go_back(){(0,u.A)().change_step(1)}},computed:{requested_direction(){return(0,Me.A)().get_requested_direction()}},watch:{requested_direction(){null!==this.requested_direction&&"backward"===this.requested_direction&&((0,Me.A)().reset_requested_direction(),this.go_back())}}};const Ye=(0,A.A)(De,[["render",He]]);var Ze=Ye;const Je={class:"row g-0"},et={class:"product_selection"},tt={class:"row"},at={class:"col-sm-6 col-md-4"},lt={class:"form-check"},ot=["id","name","onUpdate:modelValue","disabled"],it=["for"],rt={class:"text-center"},st={class:"text-center"},dt={key:0,class:"product_selection global_form row g-0"},_t=["for"],nt={class:"text-center"},ct={key:1,class:"product_selection global_form row g-0 px-0 px-md-2"},pt={class:"col-12 py-3"};function ut(e,t,a,i,r,s){const d=(0,l.g2)("Checkbox"),_=(0,l.g2)("Radio"),n=(0,l.g2)("Select"),c=(0,l.g2)("Graph");return(0,l.uX)(),(0,l.CE)("div",{class:(0,L.C4)(s.is_disabled?"the_form_is_disabled":""),id:"filters_form","data-cy":"filters"},[(0,l.Lk)("div",Je,[s.has_agent?((0,l.uX)(),(0,l.CE)("div",{key:0,onClick:t[0]||(t[0]=(...e)=>s.toggle_filters&&s.toggle_filters(...e)),class:(0,L.C4)([1===r.opened?"active":"","col filter_head text-center"])},t[5]||(t[5]=[(0,l.Lk)("p",{class:"filter_toggle"},[(0,l.Lk)("span",{class:"i_adjust"}),(0,l.eW)(" filter ")],-1)]),2)):(0,l.Q3)("",!0),s.has_options?((0,l.uX)(),(0,l.CE)("div",{key:1,onClick:t[1]||(t[1]=(...e)=>s.toggle_options&&s.toggle_options(...e)),class:(0,L.C4)([2===r.opened?"active":"","col filter_head text-center"])},t[6]||(t[6]=[(0,l.Lk)("p",{class:"filter_toggle"},[(0,l.Lk)("span",{class:"i_adjust"}),(0,l.eW)(" vlastnosti ")],-1)]),2)):(0,l.Q3)("",!0),s.has_graph?((0,l.uX)(),(0,l.CE)("div",{key:2,onClick:t[2]||(t[2]=(...e)=>s.toggle_graph&&s.toggle_graph(...e)),class:(0,L.C4)([3===r.opened?"active":"","col filter_head text-center"])},t[7]||(t[7]=[(0,l.Lk)("p",{class:"filter_toggle"},[(0,l.Lk)("span",{class:"i_adjust"}),(0,l.eW)(" graf ")],-1)]),2)):(0,l.Q3)("",!0)]),(0,l.bo)((0,l.Lk)("div",et,[(0,l.Lk)("div",tt,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(s.products_alphabetical_array,([e,t],i)=>((0,l.uX)(),(0,l.CE)("div",at,[(0,l.Lk)("div",lt,[(0,l.bo)((0,l.Lk)("input",{id:e,name:e,"onUpdate:modelValue":t=>r.values[e]=t,disabled:s.disable_in_filter(e),"true-value":"1","false-value":"0",type:"checkbox",class:"form-check-input"},null,8,ot),[[o.lH,r.values[e]]]),(0,l.Lk)("label",{for:e,class:"form-check-label"},(0,L.v_)(a.nice_filter_label[e]?a.nice_filter_label[e]:t),9,it)])]))),256))]),(0,l.Lk)("div",rt,[(0,l.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>s.filter_submit&&s.filter_submit(...e)),class:"btn btn-primary btn-m mt-3"}," Vybrať produkty ")]),(0,l.bo)((0,l.Lk)("div",st,t[8]||(t[8]=[(0,l.Lk)("p",{class:"mt-2 mb-0 text-warning"},"Minimálne jeden z produktov musí byť vybraný.",-1)]),512),[[o.aG,r.error]])],512),[[o.aG,1===r.opened]]),s.has_options?(0,l.bo)(((0,l.uX)(),(0,l.CE)("div",dt,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(s.options_hide_filter,(e,t)=>((0,l.uX)(),(0,l.CE)("div",{class:(0,L.C4)("checkbox"===e.type?"col-sm-3":"col-12")},["checkbox"!==e.type?((0,l.uX)(),(0,l.CE)("label",{key:0,for:t,class:"input-label"},(0,L.v_)(e.label),9,_t)):(0,l.Q3)("",!0),(0,l.Lk)("div",{class:(0,L.C4)("radio"===e.type?"input-area":"")},["checkbox"===e.type?((0,l.uX)(),(0,l.Wv)(d,{key:0,field_id:t,field_data:e,emit_name:"options_value_changed",onOptions_value_changed:s.options_value_changed},null,8,["field_id","field_data","onOptions_value_changed"])):"radio"===e.type?((0,l.uX)(),(0,l.Wv)(_,{key:1,field_id:t,field_data:e,emit_name:"options_value_changed",onOptions_value_changed:s.options_value_changed},null,8,["field_id","field_data","onOptions_value_changed"])):"select"===e.type?((0,l.uX)(),(0,l.Wv)(n,{key:2,field_id:t,field_data:e,emit_name:"options_value_changed",onOptions_value_changed:s.options_value_changed},null,8,["field_id","field_data","onOptions_value_changed"])):(0,l.Q3)("",!0)],2)],2))),256)),(0,l.Lk)("div",nt,[(0,l.Lk)("button",{onClick:t[4]||(t[4]=(...e)=>s.options_submit&&s.options_submit(...e)),class:"btn btn-primary btn-m mt-3"}," Prepočítať zmeny ")])],512)),[[o.aG,2===r.opened]]):(0,l.Q3)("",!0),s.has_graph?(0,l.bo)(((0,l.uX)(),(0,l.CE)("div",ct,[(0,l.Lk)("div",pt,[(0,l.bF)(c,{product_rates:a.product_rates,global_disabled:a.global_disabled},null,8,["product_rates","global_disabled"])])],512)),[[o.aG,3===r.opened]]):(0,l.Q3)("",!0)],2)}var ht=a(9126),bt=a(5683),gt=a(6488);const mt=(0,l.$V)(()=>a.e(655).then(a.bind(a,1655)));var ft={props:{got_products:Object,nice_filter_label:Object,filtered_array:Array,options_inputs:Object,disabled_from_calculate:Array,global_disabled:Boolean,product_rates:Object},components:{Checkbox:Ce.A,Radio:bt.A,Select:Le.A,Graph:mt},emits:["calculate_all_products","filters_run_own_validate","options_value_changed"],data(){return{opened:0,values:{},error:!1,inputs_changed:!1}},created(){for(let e in this.got_products){let t=parseInt(e,10);if(this.disabled_from_calculate.includes(t))return void(this.values[e]="0");0===this.filtered_array.length||this.filtered_array.includes(t)?this.values[e]="1":this.values[e]="0"}},methods:{toggle_filters(){2===this.opened&&this.inputs_changed&&this.options_submit(),this.opened=1===this.opened?0:1},toggle_options(){2===this.opened&&this.inputs_changed&&this.options_submit(),this.opened=2===this.opened?0:2},toggle_graph(){2===this.opened&&this.inputs_changed&&this.options_submit(),this.opened=3===this.opened?0:3},disable_in_filter(e){return e=parseInt(e,10),this.disabled_from_calculate.indexOf(e)>-1},filter_submit(){let e=[];for(let a in this.values)"1"===this.values[a]&&e.push(a);if(0===e.length)return void(this.error=!0);this.error=!1,e.length===Object.keys(this.got_products).length&&(e=[]),this.$emit("filters_run_own_validate");let t="filtered_products="+e.join(",");ht.A.validate_global_form(t).then(t=>{200===t.status&&((0,y.A)().set_filtered_products(e.join(",")),this.$emit("calculate_all_products"))})},options_value_changed(){this.inputs_changed=!0,this.$emit("options_value_changed")},options_submit(){let e=h.A.serialize_user_input();this.$emit("filters_run_own_validate"),ht.A.validate_global_form(e).then(e=>{200===e.status&&(this.$emit("calculate_all_products"),this.inputs_changed=!1)})}},computed:{is_disabled(){return this.global_disabled},has_options(){return Object.keys(this.options_inputs).length>0},has_agent(){return!(0,y.A)().direct_user()},has_graph(){return 3===(0,u.A)().product_group_id()&&"edu"!==(0,u.A)().get_endpoint_type()&&!(0,u.A)().is_prod_endpoint()},options_hide_filter(){let e={};for(let t in this.options_inputs)gt.A.visibility_boolean({[t]:this.options_inputs[t]})&&(e[t]=this.options_inputs[t]);return e},products_alphabetical_array(){let e=Object.entries(this.got_products);return e.sort((e,t)=>e[1].localeCompare(t[1])),e}},watch:{disabled_from_calculate(){for(let e=0;e<this.disabled_from_calculate.length;e++)this.values[this.disabled_from_calculate[e]]="0"}}};const vt=(0,A.A)(ft,[["render",ut],["__scopeId","data-v-6a56eb1d"]]);var kt=vt;const yt={class:"col-sm-4"},xt={class:"input-ttip-wrap"},At=["for"],wt={class:"validation-placeholder validation-message"};function Ct(e,t,a,o,i,r){const s=(0,l.g2)("Tooltip"),d=(0,l.g2)("Checkbox"),_=(0,l.g2)("Select"),n=(0,l.g2)("Text"),c=(0,l.g2)("Datepicker"),p=(0,l.g2)("Slider");return(0,l.uX)(),(0,l.CE)("div",{class:(0,L.C4)([r.is_disabled?"the_form_is_disabled":"","row g-0 global_form"]),"data-cy":"global_form"},[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(a.global_inputs,(o,i)=>((0,l.uX)(),(0,l.CE)("div",yt,[(0,l.Lk)("div",xt,["checkbox"!==o.type?((0,l.uX)(),(0,l.CE)("label",{key:0,for:i},(0,L.v_)(o.label),9,At)):(0,l.Q3)("",!0),"checkbox"!==o.type?((0,l.uX)(),(0,l.Wv)(s,{key:1,tooltip_text:r.tooltip(o),tooltip_type:"info"},null,8,["tooltip_text"])):(0,l.Q3)("",!0),"checkbox"===o.type?((0,l.uX)(),(0,l.Wv)(d,{key:2,field_id:i,field_data:o,emit_name:"validate_global_changed",onValidate_global_changed:t[0]||(t[0]=t=>e.$emit("validate_global_changed"))},null,8,["field_id","field_data"])):"select"===o.type?((0,l.uX)(),(0,l.Wv)(_,{key:3,field_id:i,field_data:o,emit_name:"validate_global_changed",onValidate_global_changed:t[1]||(t[1]=t=>e.$emit("validate_global_changed"))},null,8,["field_id","field_data"])):"text"===o.type?((0,l.uX)(),(0,l.Wv)(n,{key:4,field_id:i,field_data:o,emit_name:"validate_global_changed",onValidate_global_changed:t[2]||(t[2]=t=>e.$emit("validate_global_changed"))},null,8,["field_id","field_data"])):"date"===o.type?((0,l.uX)(),(0,l.Wv)(c,{key:5,field_id:i,field_data:o,emit_name:"validate_global_changed",onValidate_global_changed:t[3]||(t[3]=t=>e.$emit("validate_global_changed"))},null,8,["field_id","field_data"])):"slider"===o.type?((0,l.uX)(),(0,l.Wv)(p,{key:6,field_id:i,field_data:o,emit_name:"validate_global_changed",onValidate_global_changed:t[4]||(t[4]=t=>e.$emit("validate_global_changed"))},null,8,["field_id","field_data"])):(0,l.Q3)("",!0),"checkbox"===o.type?((0,l.uX)(),(0,l.Wv)(s,{key:7,tooltip_text:r.tooltip(o),tooltip_type:"info"},null,8,["tooltip_text"])):(0,l.Q3)("",!0),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(a.global_errors[i],(e,a)=>((0,l.uX)(),(0,l.CE)("div",wt,[t[5]||(t[5]=(0,l.Lk)("span",{class:"mark-circle mark-orange"},"!",-1)),(0,l.eW)(" "+(0,L.v_)(e),1)]))),256))])]))),256))],2)}var Lt=a(6710),Xt=a(3327),Et={props:{global_disabled:Boolean,global_inputs:Object,global_errors:Object},components:{Checkbox:Ce.A,Select:Le.A,Text:Lt.A,Datepicker:Ee.A,Slider:Xt.A,Tooltip:We.A},emits:["validate_global_changed"],data(){return{}},created(){},methods:{tooltip(e){return e?.description?e.description.replace(/\r\n/g,"<br>").replace(/&quot;/g,'"'):!!e?.block_input_hint&&e.block_input_hint.replace(/\r\n/g,"<br>").replace(/&quot;/g,'"')}},computed:{is_disabled(){return this.global_disabled}}};const Ot=(0,A.A)(Et,[["render",Ct],["__scopeId","data-v-134d44fc"]]);var jt=Ot;const Wt={class:"d-flex align-items-center flex-column flex-sm-row"};function Ft(e,t,a,i,r,s){return(0,l.bo)(((0,l.uX)(),(0,l.CE)("div",{class:(0,L.C4)([s.is_disabled?"the_form_is_disabled":"","refine-prices"])},[(0,l.Lk)("div",Wt,[t[1]||(t[1]=(0,l.Lk)("p",{class:"d-flex flex-column flex-sm-row flex-grow-1 text-center text-sm-start align-items-center"},[(0,l.Lk)("span",{class:"i_info mr-3"}),(0,l.eW)(" Uvedené ceny sú orientačné. Pre presný výpočet na mieru je potrebné doplniť ďalšie údaje. ")],-1)),(0,l.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>s.open_price&&s.open_price(...e)),class:(0,L.C4)([s.is_disabled?"the_form_is_disabled":"","btn btn-outline-primary btn-calculate"]),"data-cy":"price_form"}," Upresniť ceny ",2)])],2)),[[o.aG,s.any_is_empty_or_invalid]])}var It={props:{global_disabled:Boolean,price_inputs:Object,global_errors:Object},components:{},emits:["validate_global_changed"],data(){return{}},created(){this.any_is_empty_or_invalid?this.open_price():this.$emit("validate_global_changed")},methods:{open_price(){(0,k.A)().store_modal_data({price_inputs:this.price_inputs,price_errors:this.global_errors}),(0,k.A)().open_it("Specify_product_price")}},computed:{is_disabled(){return this.global_disabled},any_is_empty_or_invalid(){let e=!1;for(let t in this.price_inputs)(""===(0,y.A)().get_user_input(t)||this.global_errors.hasOwnProperty(t))&&(e=!0);return e}},watch:{}};const Qt=(0,A.A)(It,[["render",Ft],["__scopeId","data-v-0f90efde"]]);var Pt=Qt,Tt=a(4326),St=a(6460),zt={props:{},components:{Product_delivery:C,Product_template:Te,Step_title:Ke,Summary:Ze,Filters:kt,Bouncer_loading:v.A,Global_form:jt,Price_form:Pt},data(){return{loaded:0,total:0,got_products:{},product_order:[],update_order:[],found_with_error:[],disabled_from_calculate:[],raw_responses:{},being_calculated:[],nice_filter_label:{},product_form_tokens:{},product_rates:{},udaje:"",period:0,disable_email_pdf:!0,disable_offer:!0,ready_filters:!1,ready_price:!1,global_inputs:{},options_inputs:{},price_inputs:!1,global_errors:{},global_disabled:!0,valid_global_show_products:!0,solid_product_parts:!0,being_selected:!1,delegate_product_select:0}},created(){Promise.resolve().then(()=>je.A.session_info()).then(e=>{if(e.result?.state>=100)return(0,u.A)().change_step(5),Promise.reject("session already confirmed");1===e.result.read_only&&(0,u.A)().set_read_only()}).then(()=>Ae.get_product_list()).then(e=>(this.got_products=e.result.products,(0,y.A)().set_filtered_products(e.result.filtered_products),ht.A.get_global_form())).then(e=>{if(200!==e.status)return Promise.reject("get_global_form api failed");(0,St.A)().set_global_form(e.result.form),this.global_inputs=we.A.product_form_formatter(e.result.form,"global"),this.options_inputs=we.A.product_form_formatter(e.result.form,"options"),(0,y.A)().store_call_params(e.result.call_params),this.price_inputs=we.A.product_form_formatter(e.result.form,"price"),this.validate_global_changed()}).catch(e=>{console.log(e)})},methods:{calculate_all_products(){this.solid_product_parts=!0,this.loaded=0;let e=this.reduce_products_by_filtered();if(this.total=Object.keys(e).length,this.found_with_error=[],this.product_rates={},0===this.product_order.length)for(let t in this.got_products)this.product_order.push(parseInt(t,10));this.being_calculated=structuredClone(this.product_order),je.A.get_data().then(t=>{if(this.period=we.A.find_period(t),0!==e.length)for(let a in e)this.calculate_product(parseInt(a,10),!0);else this.count_loaded()})},calculate_product(e,t){let a=null;void 0!==this.product_form_tokens[e]&&(a=h.A.serialize_specific_inputs(this.product_form_tokens[e])),Tt.A.get_calculate(e,a,this.period).then(a=>{if(this.raw_responses[e]=a,void 0===a.result||void 0!==a.result.error||void 0===a.result[e]||"1"===a.result[e].result?.result?.disable_product?.result)return"1"===a.result?.[e]?.result?.result?.disable_product?.result?this.disabled_from_calculate.push(e):!1===a.result.validform?((0,k.A)().store_modal_data({type:"calculate_step2_form_isnt_valid",errors:a.result?.form_validation_error_elements,is_client_role:!1}),(0,k.A)().open_it("Ordinary_error_modal")):console.log("#"+e+" had error",a),this.found_with_error.push(e),this.total--,void this.count_loaded();this.udaje=we.A.search_for_udaje(a),this.disable_email_pdf="1"===a.result[e].result?.product?.disable_email_pdf?.result,this.disable_offer="1"===a.result[e].result?.product?.disable_offer?.result,this.nice_filter_label[e]=a.result[e].result?.head?.provider_name?.formula_name||void 0,this.product_rates[e]={name:this.got_products[e],rate:a.result[e].result?.result?.discount?.result};let l=we.A.product_form_formatter(a.result[e].result?.results_form?.comment,"calculate");this.product_form_tokens[e]=Object.keys(l),(0,y.A)().store_call_params(a.result.call_params),t&&(this.update_order=we.A.find_order(a,null,e)),this.loaded++,this.count_loaded();let o=this.being_calculated.indexOf(e);o>-1&&delete this.being_calculated[o]})},recalculate_product(e){this.loaded--,this.count_loaded(),this.being_calculated.push(e),this.calculate_product(e,!1)},count_loaded(){this.loaded===this.total?(this.global_disabled=!1,this.ready_filters=!0,this.product_order=this.update_order):this.global_disabled=!0},reduce_products_by_filtered(){if(0===this.filtered_array.length)return this.got_products;let e=[];for(let t in this.got_products)-1!==this.filtered_array.indexOf(parseInt(t,10))&&(e[t]=this.got_products[t]);return e},validate_global_changed(){this.global_disabled=!0,this.global_errors={};let e=h.A.serialize_specific_inputs(Object.keys(this.global_inputs));ht.A.validate_global_form(e).then(e=>{if(!0!==e.result.validform)return this.global_errors=e.result.form_validation_error_elements,this.valid_global_show_products=!1,this.global_disabled=!1,void(this.ready_price=!0);!this.price_inputs||this.ready_price?(this.valid_global_show_products=!0,this.calculate_all_products()):this.ready_price=!0})},filters_run_own_validate(){this.global_disabled=!0},select_running(e){this.being_selected=e,this.global_disabled=e},options_value_changed(){this.solid_product_parts=!1}},computed:{user_data(){return this.udaje},only_displayed_products(){let e,t=[],a=this.product_order.length;for(e=0;e<a;e++){let a=parseInt(this.product_order[e],10);-1!==this.found_with_error.indexOf(a)||0!==this.filtered_array.length&&-1===this.filtered_array.indexOf(a)||t.push(a)}return t},filtered_array(){let e,t=(0,y.A)().get_filtered_products()?.split(","),a=[],l=t.length;for(e=0;e<l;e++)""!==t[e]&&a.push(parseInt(t[e],10));return a},display_filters(){return!!this.ready_filters},classic_np_nav(){return!(0,u.A)().is_zeteo_skin()},closing_modal(){return(0,k.A)().get_modal_event_data()}},watch:{closing_modal(){if(null!==this.closing_modal){if("specify_recalculate"===this.closing_modal)this.validate_global_changed();else if(h.A.starts_with(this.closing_modal,"indicative_price_")){let e=this.closing_modal.replace("indicative_price_","");e=parseInt(e,10),this.delegate_product_select=e}else{let e=this.closing_modal;this.recalculate_product(e)}(0,k.A)().del_modal_event_data()}}}};const Gt=(0,A.A)(zt,[["render",_],["__scopeId","data-v-3bcbfbd4"]]);var Vt=Gt},8856:function(e,t,a){var l=a(8700),o=a(6343),i=a(3175),r=a(3177);class s{get_it(e){!1===e&&(e=(0,r.A)().get_selected_product().next_contract);let t={action_name:"gethtml",method:"POST",url:(0,l.A)().endpoint_url()+"online/gethtml/?id="+e+o.A.add_token_as_parameter()},a=new i.A;return a.prepare_params(t).handle_response().catch(e=>{throw e})}get_json_api(e){let t={action_name:"getjson",method:"POST",url:(0,l.A)().endpoint_url()+"online/getjson/?id="+e+o.A.add_token_as_parameter()},a=new i.A;return a.prepare_params(t).handle_response().catch(e=>{throw e})}}t.A=new s}}]);