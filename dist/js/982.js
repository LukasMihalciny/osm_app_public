"use strict";(self["webpackChunkosmapp_webpack_3x25x"]=self["webpackChunkosmapp_webpack_3x25x"]||[]).push([[982],{3175:function(e,t,a){var s=a(1114),n=(a(6573),a(8100),a(7936),a(9577),a(4979),a(8700)),r=a(2873),o=a(5833),i=a(2754),_=a(3177);class p{constructor(){(0,s.A)(this,"params",{}),(0,s.A)(this,"headers",{}),(0,s.A)(this,"auth_fails",0),(0,s.A)(this,"auth_max",6)}prepare_params(e){return this.params=e,void 0===this.params.timeout&&(this.params.timeout=29),this.headers={method:this.params.method,mode:"cors",cache:"no-cache",credentials:"omit",signal:(0,i.A)().get_abort_signal(),headers:{"x-user-scope":(0,n.A)().give_api_scope(),Authorization:(0,n.A)().give_bearer(),Accept:"application/json"}},"POST"===this.params.method&&this.params.body&&(this.headers.body=this.params.body),void 0===this.params.content_type?this.headers.headers["Content-Type"]="application/x-www-form-urlencoded":null!==this.params.content_type&&(this.headers.headers["Content-Type"]=this.params.content_type),this}async unauthorized(){let e=(0,n.A)().get_backend_type(),t=(0,n.A)().get_endpoint_type(),a=(0,_.A)().get_receiver(),s={php_wrapper:"/authorize_frontend/?endpoint="+t+"&receiver="+a,np_wp:"/wp-content/themes/najpoistenie/api_php_requests/authorize_frontend.php",fp_symfony:"/osmapp/auth/?receiver="+a,np_symfony:"/osmapp/auth/",wrapper_sf:"/osmapp/auth/?endpoint="+t+"&receiver="+a};if(s.hasOwnProperty(e)){let t=window.location.origin+s[e];return fetch(t).then(e=>e.json()).then(t=>{if(!t)return!1;if("np_symfony"===e&&t.length>86){let e=atob(t),a=new Uint8Array(e.length);for(let t=0;t<e.length;t++)a[t]=571^e.charCodeAt(t);let s=(new TextDecoder).decode(a).replace("saalt11","");t=s}return(0,n.A)().save_bearer(t),!0})}if("lukas_local"===e){let e="http://wrapper.local/authorize_frontend/?endpoint="+t+"&receiver="+a;return fetch(e).then(e=>e.json()).then(e=>((0,n.A)().save_bearer(e),console.log("NEW BEARER:"),console.log(e),!0))}return"vue"===e?(console.log("VUE does not have 401 auth service, fill access_token into env.js"),!1):"myport"===e?(0,n.A)().myport_access_token_promise().then(e=>!1!==e&&((0,n.A)().save_bearer(e),!0)):(console.log("backend_type "+e+" has no access to new authorization"),!1)}switch_receiver(){let e=(0,n.A)().get_backend_type(),t=(0,n.A)().get_endpoint_type(),a=(0,_.A)().get_receiver(),s={lukas_local:"http://wrapper.local/authorize_frontend/?endpoint="+t+"&receiver="+a+"&cache=allow",wrapper_sf:window.location.origin+"/osmapp/auth/?endpoint="+t+"&receiver="+a+"&cache=allow"};if("vue"===e)return!0;if(!s.hasOwnProperty(e))return console.log("only lukas_local and wrapper_sf backend_types has access to this method"),!1;let r=s[e];return fetch(r).then(e=>e.json()).then(e=>!!e&&((0,n.A)().save_bearer(e),!0))}async handle_response(){let e=await this.call_the_api_request();if(200===e.status)return this.auth_fails=0,e;if(401===e.status){if(this.auth_fails++,this.auth_fails>this.auth_max)return console.log("Authorization reched maximum attempts. Try to refresh the app or report to admin."),{};let e=await this.unauthorized();return e?await this.prepare_params(this.params).handle_response():null}if(423===e.status&&-1===["car-data-search","car-valuation-options","car-valuation-price"].indexOf(this.params.action_name))return(0,r.A)().open_it("Clearance"),e;if(503===e.status)return(0,n.A)().change_step(503),e;if(408===e.status)return console.log("408 in request "+this.params.action_name),-1===["calculate_step2","calculate_step4","confirm"].indexOf(this.params.action_name)&&(0,r.A)().open_it("Server_timeout"),e;if(500===e.status&&"calculate_step2"===this.params.action_name||422===e.status&&"confirm"===this.params.action_name||412===e.status&&"confirm"===this.params.action_name||422===e.status&&"getsessioninfo"===this.params.action_name||"ico-info"===this.params.action_name||["car-data-search","car-valuation-options","car-valuation-price"].indexOf(this.params.action_name)>-1||422===e.status&&"session-remap"===this.params.action_name||422===e.status&&"id-scan/add-page"===this.params.action_name||422===e.status&&"id-scan/get-scan-groups"===this.params.action_name||422===e.status&&"identity-scan-check"===this.params.action_name||422===e.status&&"identity-scan"===this.params.action_name||(422===e.status||409===e.status)&&"signature-code-check"===this.params.action_name||(422===e.status||409===e.status)&&"signature-code-send"===this.params.action_name||500===e.status&&"id-scan/get-scan-groups"===this.params.action_name||425===e.status&&"id-scan/get-scan-groups"===this.params.action_name||425===e.status&&"id-scan/get-scan-group-documents"===this.params.action_name||422===e.status&&"payment-create"===this.params.action_name||422===e.status&&"offer-notify"===this.params.action_name)return e;{let t=(new Date).toLocaleString(),a=(0,n.A)().get_session_token(),s=(0,n.A)().current_step();return(0,o.A)().set_last_request(this.headers,this.params,t,a,s,e),(0,n.A)().change_step(404),(0,r.A)().close_them_all(),e}}call_the_api_request(){return new Promise((e,t)=>{let a=setTimeout(function(){return e({status:408,statusText:"Request Timeout"})},1e3*this.params.timeout),s={};fetch(this.params.url,this.headers).then(e=>{s=e;let t=e.headers.get("content-type");return-1===t.indexOf("json")?{response:"not in json format"}:e.json()}).then(t=>{s.result=t,e(s)}).catch(e=>{"AbortError"===e.name?(clearTimeout(a),console.log("abort",this.params.action_name)):console.error("Fetch error:",e)})})}}t.A=p},3952:function(e,t,a){a.d(t,{A:function(){return q}});var s=a(641),n=a(33),r=a(3751);const o={key:0,class:"info_fixed_separator"},i={class:"d-block"},_=["title"],p={title:"endpoint"},c={title:"receiver name (id)"},u={title:"session token"},l={title:"agent code"},h={title:"product name : product id"},d={title:"filtred products"},m={title:"osmapp version"},f={key:0},g={key:1,class:"session_cookie_manager"},A={class:"text-end col-sticky"},w={class:"ms-3"};function k(e,t,a,k,v,y){return(0,s.uX)(),(0,s.CE)(s.FK,null,[y.is_fixed?((0,s.uX)(),(0,s.CE)("div",o)):(0,s.Q3)("",!0),(0,s.bo)((0,s.Lk)("section",{class:(0,n.C4)(["info_for_session text-center",y.is_fixed?"fixed_to_top":""]),"data-cy":"https://youtu.be/dQw4w9WgXcQ"},[(0,s.Lk)("div",i,[(0,s.Lk)("h2",{title:y.print_group},(0,n.v_)(y.heading),9,_),(0,s.Lk)("p",p,(0,n.v_)(y.print_endpoint),1),(0,s.Lk)("p",c,(0,n.v_)(y.print_receiver),1),(0,s.Lk)("p",u,(0,n.v_)(y.print_session_token),1),(0,s.Lk)("p",l,(0,n.v_)(y.print_agent_code),1),(0,s.Lk)("p",h,(0,n.v_)(y.print_product),1),(0,s.Lk)("p",d,(0,n.v_)(y.print_filtered_products),1),(0,s.Lk)("p",m,(0,n.v_)(y.print_version),1),y.print_flow?((0,s.uX)(),(0,s.CE)("p",f,(0,n.v_)(y.print_flow),1)):(0,s.Q3)("",!0),y.session_actions_shown?((0,s.uX)(),(0,s.CE)("p",g,[(0,s.Lk)("span",A,[(0,s.Lk)("span",{class:"i_action menu",title:"Menu",onClick:t[0]||(t[0]=(...e)=>y.return_to_session_manager&&y.return_to_session_manager(...e))}),(0,s.Lk)("span",{class:"i_action share",title:"Share",onClick:t[1]||(t[1]=(...e)=>y.open_session_share&&y.open_session_share(...e))}),(0,s.Lk)("span",{class:"i_action autofill",title:"Autofill",onClick:t[2]||(t[2]=(...e)=>y.autofill_session_params&&y.autofill_session_params(...e))}),(0,s.Lk)("span",w,(0,n.v_)(y.print_note),1)])])):(0,s.Q3)("",!0)])],2),[[r.aG,y.info_shown]])],64)}var v=a(8700),y=a(3177),b=(a(5833),a(5143)),x=a(9614),L=(a(6460),a(2873)),C=a(9819),j=(a(2754),a(1190)),z=a(7151),E={props:{},components:{},emits:[],data(){return{}},created(){},methods:{return_to_session_manager(){j.A.reset_session_config(),z.A.delete_keep(),(0,v.A)().set_manager_view(!0)},open_session_share(){(0,L.A)().store_modal_data(null),(0,L.A)().open_it("Share_session")},autofill_session_params(){(0,y.A)().autofill_run()}},computed:{group_id(){return(0,v.A)().product_group_id()},heading(){return"docs_landing"===(0,v.A)().get_run_mode()?"docs_landing | upload page":"node_red"===(0,v.A)().get_run_mode()?"node_red | "+(0,b.A)().get_workflow_name():(0,v.A)().is_manager_view()?"cookie session manager":C.A.group_name(this.group_id)},print_group(){return"docs_landing"===(0,v.A)().get_run_mode()?"":"node_red"===(0,v.A)().get_run_mode()?"flow name, for id: "+(0,v.A)().get_flow_id():"group name, for id: "+this.group_id},print_session_token(){return(0,v.A)().get_session_token()||"-"},print_agent_code(){return(0,y.A)().get_agent_code()||"-"},print_product(){let e=(0,y.A)().get_selected_product();return(e.product_nice_name?e.product_nice_name:"")+" : "+(e.product_id?e.product_id:"")},print_filtered_products(){return(0,y.A)().get_filtered_products()||"-"},print_version(){return(0,v.A)().give_app_version()},print_endpoint(){return(0,v.A)().get_endpoint_type()},print_receiver(){let e=(0,y.A)().get_receiver();return C.A.receiver_names()[e]+" ("+e+")"},print_flow(){if("node_red"!==(0,v.A)().get_run_mode())return!1;let e="state: "+(0,b.A)().get_workflow_step_state();e+=" | step: "+(0,b.A)().get_workflow_step(),e+=" | finished: "+((0,b.A)().get_workflow_finished()?"true":"false"),e+=" | internal: "+((0,b.A)().get_workflow_internal()?"true":"false");let t=(0,b.A)().get_workflow_actions();for(let a in t)e+=" | "+t[a].function+": "+t[a].state;return e},info_shown(){return!(0,v.A)().is_prod_endpoint()||(0,y.A)().capable_agent()||(0,x.A)().show_info_section()},session_actions_shown(){return"improved"===(0,v.A)().cookie_manager_type()},print_note(){return(0,v.A)().get_user_note()},is_fixed(){return"wrapper_sf"===(0,v.A)().get_backend_type()}},watch:{}},T=a(6262);const O=(0,T.A)(E,[["render",k]]);var q=O}}]);